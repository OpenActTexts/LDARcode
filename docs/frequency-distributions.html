<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Loss Data Analytics</title>
  <meta name="description" content="This site provides files that generate R codes to support the online text Loss Data Analytics.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R for Loss Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This site provides files that generate R codes to support the online text Loss Data Analytics." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Loss Data Analytics" />
  
  <meta name="twitter:description" content="This site provides files that generate R codes to support the online text Loss Data Analytics." />
  

<meta name="author" content="An open text authored by the Actuarial Community">


<meta name="date" content="2018-06-11">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction-to-loss-data-analytics.html">
<link rel="next" href="modeling-loss-severities.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />








<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan, pre.js');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Loss Data Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1" data-path="prerequisites.html"><a href="prerequisites.html#basic-programming-tools"><i class="fa fa-check"></i><b>1.1</b> Basic Programming Tools</a></li>
<li class="chapter" data-level="1.2" data-path="prerequisites.html"><a href="prerequisites.html#further-programming-tools"><i class="fa fa-check"></i><b>1.2</b> Further Programming Tools</a></li>
<li class="chapter" data-level="1.3" data-path="prerequisites.html"><a href="prerequisites.html#r-markdown"><i class="fa fa-check"></i><b>1.3</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-loss-data-analytics.html"><a href="introduction-to-loss-data-analytics.html"><i class="fa fa-check"></i><b>2</b> Introduction to Loss Data Analytics</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-loss-data-analytics.html"><a href="introduction-to-loss-data-analytics.html#case-study-wisconsin-property-fund"><i class="fa fa-check"></i><b>2.1</b> Case Study: Wisconsin Property Fund</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-loss-data-analytics.html"><a href="introduction-to-loss-data-analytics.html#fund-claims-variables"><i class="fa fa-check"></i><b>2.1.1</b> Fund Claims Variables</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction-to-loss-data-analytics.html"><a href="introduction-to-loss-data-analytics.html#rating-variables"><i class="fa fa-check"></i><b>2.1.2</b> Rating Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="frequency-distributions.html"><a href="frequency-distributions.html"><i class="fa fa-check"></i><b>3</b> Frequency Distributions</a><ul>
<li class="chapter" data-level="3.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#basic-distributions"><i class="fa fa-check"></i><b>3.1</b> Basic Distributions</a><ul>
<li class="chapter" data-level="3.1.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#poisson-distribution"><i class="fa fa-check"></i><b>3.1.1</b> Poisson Distribution</a></li>
<li class="chapter" data-level="3.1.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>3.1.2</b> Negative Binomial Distribution</a></li>
<li class="chapter" data-level="3.1.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>3.1.3</b> Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#ab0-class-of-distributions"><i class="fa fa-check"></i><b>3.2</b> (<em>a</em>,<em>b</em>,0) Class of Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#estimating-frequency-distributions"><i class="fa fa-check"></i><b>3.3</b> Estimating Frequency Distributions</a><ul>
<li class="chapter" data-level="3.3.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#singapore-data"><i class="fa fa-check"></i><b>3.3.1</b> Singapore Data</a></li>
<li class="chapter" data-level="3.3.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#claim-frequency-distribution-1"><i class="fa fa-check"></i><b>3.3.2</b> Claim Frequency Distribution</a></li>
<li class="chapter" data-level="3.3.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#visualize-the-loglikelihood-function"><i class="fa fa-check"></i><b>3.3.3</b> Visualize The Loglikelihood Function</a></li>
<li class="chapter" data-level="3.3.4" data-path="frequency-distributions.html"><a href="frequency-distributions.html#the-maximum-likelihood-estimate-of-poisson-distribution"><i class="fa fa-check"></i><b>3.3.4</b> The Maximum Likelihood Estimate of Poisson Distribution</a></li>
<li class="chapter" data-level="3.3.5" data-path="frequency-distributions.html"><a href="frequency-distributions.html#the-maximum-likelihood-estimate-of-the-negative-binomial-distribution"><i class="fa fa-check"></i><b>3.3.5</b> The Maximum Likelihood Estimate of The Negative Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="frequency-distributions.html"><a href="frequency-distributions.html#goodness-of-fit"><i class="fa fa-check"></i><b>3.4</b> Goodness of Fit</a><ul>
<li class="chapter" data-level="3.4.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#pearson-goodness-of-fit-statistic"><i class="fa fa-check"></i><b>3.4.1</b> Pearson Goodness-of-Fit Statistic</a></li>
<li class="chapter" data-level="3.4.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#negative-binomial-goodness-of-fit-statistic"><i class="fa fa-check"></i><b>3.4.2</b> Negative Binomial Goodness-of-Fit Statistic</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html"><i class="fa fa-check"></i><b>4</b> Modeling Loss Severities</a><ul>
<li class="chapter" data-level="4.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#required-packages"><i class="fa fa-check"></i><b>4.1</b> Required packages</a></li>
<li class="chapter" data-level="4.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#gamma-distribution"><i class="fa fa-check"></i><b>4.2</b> Gamma Distribution</a><ul>
<li class="chapter" data-level="4.2.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-shape-parameter"><i class="fa fa-check"></i><b>4.2.1</b> Varying The Shape Parameter</a></li>
<li class="chapter" data-level="4.2.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-scale-parameter"><i class="fa fa-check"></i><b>4.2.2</b> Varying The Scale Parameter</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#pareto-distribution"><i class="fa fa-check"></i><b>4.3</b> Pareto Distribution</a><ul>
<li class="chapter" data-level="4.3.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-shape-parameter-1"><i class="fa fa-check"></i><b>4.3.1</b> Varying The Shape Parameter</a></li>
<li class="chapter" data-level="4.3.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-scale-parameter-1"><i class="fa fa-check"></i><b>4.3.2</b> Varying The Scale Parameter</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#weibull-distribution"><i class="fa fa-check"></i><b>4.4</b> Weibull Distribution</a><ul>
<li class="chapter" data-level="4.4.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-shape-parameter-2"><i class="fa fa-check"></i><b>4.4.1</b> Varying The Shape Parameter</a></li>
<li class="chapter" data-level="4.4.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-scale-parameter-2"><i class="fa fa-check"></i><b>4.4.2</b> Varying The Scale Parameter</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#generalized-beta-distribution-of-the-second-kind-gb2"><i class="fa fa-check"></i><b>4.5</b> Generalized Beta Distribution of The Second Kind (GB2)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-scale-parameter-3"><i class="fa fa-check"></i><b>4.5.1</b> Varying The Scale Parameter</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#methods-of-creating-new-distributions"><i class="fa fa-check"></i><b>4.6</b> Methods of Creating New Distributions</a><ul>
<li class="chapter" data-level="4.6.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#mixture-distributions"><i class="fa fa-check"></i><b>4.6.1</b> Mixture Distributions</a></li>
<li class="chapter" data-level="4.6.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#density-obtained-through-splicing"><i class="fa fa-check"></i><b>4.6.2</b> Density Obtained Through Splicing</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#coverage-modifications"><i class="fa fa-check"></i><b>4.7</b> Coverage Modifications</a><ul>
<li class="chapter" data-level="4.7.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#load-required-package"><i class="fa fa-check"></i><b>4.7.1</b> Load Required Package</a></li>
<li class="chapter" data-level="4.7.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#ordinary-deductible"><i class="fa fa-check"></i><b>4.7.2</b> Ordinary Deductible</a></li>
<li class="chapter" data-level="4.7.3" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#franchise-deductible"><i class="fa fa-check"></i><b>4.7.3</b> Franchise Deductible</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-selection.html"><a href="model-selection.html"><i class="fa fa-check"></i><b>5</b> Model Selection</a><ul>
<li class="chapter" data-level="5.1" data-path="model-selection.html"><a href="model-selection.html#claim-level-data-of-property-fund"><i class="fa fa-check"></i><b>5.1</b> Claim Level Data of Property Fund</a><ul>
<li class="chapter" data-level="5.1.1" data-path="model-selection.html"><a href="model-selection.html#claims-data"><i class="fa fa-check"></i><b>5.1.1</b> Claims Data</a></li>
<li class="chapter" data-level="5.1.2" data-path="model-selection.html"><a href="model-selection.html#summary-of-claims"><i class="fa fa-check"></i><b>5.1.2</b> Summary of Claims</a></li>
<li class="chapter" data-level="5.1.3" data-path="model-selection.html"><a href="model-selection.html#plot-of-claims"><i class="fa fa-check"></i><b>5.1.3</b> Plot of Claims</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="model-selection.html"><a href="model-selection.html#fitting-distributions"><i class="fa fa-check"></i><b>5.2</b> Fitting Distributions</a><ul>
<li class="chapter" data-level="5.2.1" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-a-lognormal-distribution"><i class="fa fa-check"></i><b>5.2.1</b> Inference Assuming a Lognormal Distribution</a></li>
<li class="chapter" data-level="5.2.2" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-a-gamma-distribution"><i class="fa fa-check"></i><b>5.2.2</b> Inference Assuming a Gamma Distribution</a></li>
<li class="chapter" data-level="5.2.3" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-a-pareto-distribution"><i class="fa fa-check"></i><b>5.2.3</b> Inference Assuming a Pareto Distribution</a></li>
<li class="chapter" data-level="5.2.4" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-an-exponential-distribution"><i class="fa fa-check"></i><b>5.2.4</b> Inference Assuming an Exponential Distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-a-generalized-beta-distribution-of-the-second-kind-gb2-distribution"><i class="fa fa-check"></i><b>5.2.5</b> Inference Assuming a Generalized Beta Distribution of the Second Kind (GB2) Distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="model-selection.html"><a href="model-selection.html#plotting-the-fit-using-densities-on-a-logarithmic-scale"><i class="fa fa-check"></i><b>5.3</b> Plotting the Fit Using Densities (on a Logarithmic Scale)</a></li>
<li class="chapter" data-level="5.4" data-path="model-selection.html"><a href="model-selection.html#nonparametric-inference"><i class="fa fa-check"></i><b>5.4</b> Nonparametric Inference</a><ul>
<li class="chapter" data-level="5.4.1" data-path="model-selection.html"><a href="model-selection.html#nonparametric-estimation-tools"><i class="fa fa-check"></i><b>5.4.1</b> Nonparametric Estimation Tools</a></li>
<li class="chapter" data-level="5.4.2" data-path="model-selection.html"><a href="model-selection.html#property-fund-data"><i class="fa fa-check"></i><b>5.4.2</b> Property Fund Data</a></li>
<li class="chapter" data-level="5.4.3" data-path="model-selection.html"><a href="model-selection.html#nonparametric-estimation-tools-for-model-selection"><i class="fa fa-check"></i><b>5.4.3</b> Nonparametric Estimation Tools For Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="model-selection.html"><a href="model-selection.html#mle-for-grouped-data"><i class="fa fa-check"></i><b>5.5</b> MLE for Grouped Data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="model-selection.html"><a href="model-selection.html#mle-for-grouped-data--soa-exam-c-276"><i class="fa fa-check"></i><b>5.5.1</b> MLE for Grouped Data- SOA Exam C # 276</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>6</b> Simulation</a><ul>
<li class="chapter" data-level="6.1" data-path="simulation.html"><a href="simulation.html#simulation---inversion-method"><i class="fa fa-check"></i><b>6.1</b> Simulation - Inversion Method</a></li>
<li class="chapter" data-level="6.2" data-path="simulation.html"><a href="simulation.html#comparing-moments-from-the-simulated-data-to-theoretical-moments"><i class="fa fa-check"></i><b>6.2</b> Comparing Moments from The Simulated Data to Theoretical Moments</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html"><i class="fa fa-check"></i><b>7</b> Aggregate Claim Simulation</a><ul>
<li class="chapter" data-level="7.1" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#collective-risk-model-without-coverage-modifications"><i class="fa fa-check"></i><b>7.1</b> Collective Risk Model: without coverage modifications</a><ul>
<li class="chapter" data-level="7.1.1" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#set-parameters"><i class="fa fa-check"></i><b>7.1.1</b> Set Parameters</a></li>
<li class="chapter" data-level="7.1.2" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#show-frequency-and-severity-distributions"><i class="fa fa-check"></i><b>7.1.2</b> Show frequency and severity distributions</a></li>
<li class="chapter" data-level="7.1.3" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#set-sample-size-for-the-simulation"><i class="fa fa-check"></i><b>7.1.3</b> Set sample size for the simulation</a></li>
<li class="chapter" data-level="7.1.4" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#show-distribution-of-aggregate-loss-s"><i class="fa fa-check"></i><b>7.1.4</b> Show distribution of aggregate loss S</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#applications"><i class="fa fa-check"></i><b>7.2</b> Applications</a><ul>
<li class="chapter" data-level="7.2.1" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#find-descriptive-statistics"><i class="fa fa-check"></i><b>7.2.1</b> Find descriptive statistics</a></li>
<li class="chapter" data-level="7.2.2" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#calculate-cdf"><i class="fa fa-check"></i><b>7.2.2</b> Calculate cdf</a></li>
<li class="chapter" data-level="7.2.3" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#calculate-risk-measures"><i class="fa fa-check"></i><b>7.2.3</b> Calculate risk measures</a></li>
<li class="chapter" data-level="7.2.4" data-path="aggregate-claim-simulation.html"><a href="aggregate-claim-simulation.html#pricing-stop-loss-insurance---set-deductible"><i class="fa fa-check"></i><b>7.2.4</b> Pricing stop-loss insurance - Set deductible</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="freqsev.html"><a href="freqsev.html"><i class="fa fa-check"></i><b>8</b> FreqSev</a><ul>
<li class="chapter" data-level="8.1" data-path="freqsev.html"><a href="freqsev.html#getting-the-data"><i class="fa fa-check"></i><b>8.1</b> Getting the Data</a><ul>
<li class="chapter" data-level="8.1.1" data-path="freqsev.html"><a href="freqsev.html#read-data-massauto.csv"><i class="fa fa-check"></i><b>8.1.1</b> read data “MassAuto.csv”</a></li>
<li class="chapter" data-level="8.1.2" data-path="freqsev.html"><a href="freqsev.html#check-variable-names"><i class="fa fa-check"></i><b>8.1.2</b> Check Variable Names</a></li>
<li class="chapter" data-level="8.1.3" data-path="freqsev.html"><a href="freqsev.html#calculate-total-losses-in-dat"><i class="fa fa-check"></i><b>8.1.3</b> Calculate Total Losses in “dat”</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="freqsev.html"><a href="freqsev.html#fit-frequency-models"><i class="fa fa-check"></i><b>8.2</b> Fit Frequency Models</a><ul>
<li class="chapter" data-level="8.2.1" data-path="freqsev.html"><a href="freqsev.html#prepare-data-for-frequency-models"><i class="fa fa-check"></i><b>8.2.1</b> Prepare Data for Frequency Models</a></li>
<li class="chapter" data-level="8.2.2" data-path="freqsev.html"><a href="freqsev.html#fit-poisson-distribution"><i class="fa fa-check"></i><b>8.2.2</b> Fit Poisson distribution</a></li>
<li class="chapter" data-level="8.2.3" data-path="freqsev.html"><a href="freqsev.html#fit-negative-binomial-distribution"><i class="fa fa-check"></i><b>8.2.3</b> Fit Negative Binomial Distribution</a></li>
<li class="chapter" data-level="8.2.4" data-path="freqsev.html"><a href="freqsev.html#goodness-of-fit-1"><i class="fa fa-check"></i><b>8.2.4</b> Goodness-of-Fit</a></li>
<li class="chapter" data-level="8.2.5" data-path="freqsev.html"><a href="freqsev.html#chi-square-statistics"><i class="fa fa-check"></i><b>8.2.5</b> Chi Square Statistics</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="freqsev.html"><a href="freqsev.html#fit-severity-models"><i class="fa fa-check"></i><b>8.3</b> Fit Severity Models</a><ul>
<li class="chapter" data-level="8.3.1" data-path="freqsev.html"><a href="freqsev.html#prepare-data-for-severity-models"><i class="fa fa-check"></i><b>8.3.1</b> Prepare Data for Severity Models</a></li>
<li class="chapter" data-level="8.3.2" data-path="freqsev.html"><a href="freqsev.html#log-normal-distribution"><i class="fa fa-check"></i><b>8.3.2</b> Log-normal distribution</a></li>
<li class="chapter" data-level="8.3.3" data-path="freqsev.html"><a href="freqsev.html#pareto-distribution-1"><i class="fa fa-check"></i><b>8.3.3</b> Pareto Distribution</a></li>
<li class="chapter" data-level="8.3.4" data-path="freqsev.html"><a href="freqsev.html#histogram"><i class="fa fa-check"></i><b>8.3.4</b> Histogram</a></li>
<li class="chapter" data-level="8.3.5" data-path="freqsev.html"><a href="freqsev.html#qq-plots"><i class="fa fa-check"></i><b>8.3.5</b> qq Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tweedie.html"><a href="tweedie.html"><i class="fa fa-check"></i><b>9</b> Tweedie</a><ul>
<li class="chapter" data-level="9.1" data-path="tweedie.html"><a href="tweedie.html#tweedie-distribution"><i class="fa fa-check"></i><b>9.1</b> Tweedie distribution</a><ul>
<li class="chapter" data-level="9.1.1" data-path="tweedie.html"><a href="tweedie.html#load-tweedie-package"><i class="fa fa-check"></i><b>9.1.1</b> Load Tweedie Package</a></li>
<li class="chapter" data-level="9.1.2" data-path="tweedie.html"><a href="tweedie.html#set-paramteres-for-tweediepmuphi"><i class="fa fa-check"></i><b>9.1.2</b> Set Paramteres for Tweedie(p,mu,phi)</a></li>
<li class="chapter" data-level="9.1.3" data-path="tweedie.html"><a href="tweedie.html#set-sample-size"><i class="fa fa-check"></i><b>9.1.3</b> Set Sample Size</a></li>
<li class="chapter" data-level="9.1.4" data-path="tweedie.html"><a href="tweedie.html#show-summary-statistics"><i class="fa fa-check"></i><b>9.1.4</b> Show Summary Statistics</a></li>
<li class="chapter" data-level="9.1.5" data-path="tweedie.html"><a href="tweedie.html#show-histogram"><i class="fa fa-check"></i><b>9.1.5</b> Show Histogram</a></li>
<li class="chapter" data-level="9.1.6" data-path="tweedie.html"><a href="tweedie.html#qq-plots-for-different-p-values"><i class="fa fa-check"></i><b>9.1.6</b> QQ Plots for Different p Values</a></li>
<li class="chapter" data-level="9.1.7" data-path="tweedie.html"><a href="tweedie.html#fit-tweedie-distribution"><i class="fa fa-check"></i><b>9.1.7</b> Fit Tweedie Distribution</a></li>
<li class="chapter" data-level="9.1.8" data-path="tweedie.html"><a href="tweedie.html#show-parameter-estimates"><i class="fa fa-check"></i><b>9.1.8</b> Show Parameter Estimates</a></li>
<li class="chapter" data-level="9.1.9" data-path="tweedie.html"><a href="tweedie.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>9.1.9</b> Maximum Likelihood Estimation</a></li>
<li class="chapter" data-level="9.1.10" data-path="tweedie.html"><a href="tweedie.html#obtain-standard-error-4"><i class="fa fa-check"></i><b>9.1.10</b> Obtain Standard Error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html"><i class="fa fa-check"></i><b>10</b> Bootstrap Estimation</a><ul>
<li class="chapter" data-level="10.1" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#empirical-bootstrap"><i class="fa fa-check"></i><b>10.1</b> Empirical Bootstrap</a><ul>
<li class="chapter" data-level="10.1.1" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#random-sample"><i class="fa fa-check"></i><b>10.1.1</b> Random sample</a></li>
<li class="chapter" data-level="10.1.2" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#sample-mean"><i class="fa fa-check"></i><b>10.1.2</b> Sample mean</a></li>
<li class="chapter" data-level="10.1.3" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#random-resamples-from-y"><i class="fa fa-check"></i><b>10.1.3</b> Random resamples from y</a></li>
<li class="chapter" data-level="10.1.4" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#confidence-interval"><i class="fa fa-check"></i><b>10.1.4</b> 90% confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#parametric-bootstrap"><i class="fa fa-check"></i><b>10.2</b> Parametric Bootstrap</a><ul>
<li class="chapter" data-level="10.2.1" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#random-sample-of-size-250"><i class="fa fa-check"></i><b>10.2.1</b> random sample of size 250</a></li>
<li class="chapter" data-level="10.2.2" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#the-mle-for-lambda-1xbar"><i class="fa fa-check"></i><b>10.2.2</b> The MLE for lambda: 1/xbar</a></li>
<li class="chapter" data-level="10.2.3" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#generate-bootstrap-samples"><i class="fa fa-check"></i><b>10.2.3</b> Generate bootstrap samples</a></li>
<li class="chapter" data-level="10.2.4" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#compute-botstrap-statistics"><i class="fa fa-check"></i><b>10.2.4</b> compute botstrap statistics</a></li>
<li class="chapter" data-level="10.2.5" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#calculate-deviation-from-sample-statistics"><i class="fa fa-check"></i><b>10.2.5</b> calculate deviation from sample statistics</a></li>
<li class="chapter" data-level="10.2.6" data-path="bootstrap-estimation.html"><a href="bootstrap-estimation.html#confidence-intervel"><i class="fa fa-check"></i><b>10.2.6</b> 90% confidence intervel</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Loss Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="frequency-distributions" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Frequency Distributions</h1>
<p><em>This file contains illustrative <strong>R</strong> code for computing important count distributions. When reviewing this code, you should open an <strong>R</strong> session, copy-and-paste the code, and see it perform. Then, you will be able to change parameters, look up commands, and so forth, as you go.</em></p>
<div id="basic-distributions" class="section level2 tabset">
<h2><span class="header-section-number">3.1</span> Basic Distributions</h2>
<div id="poisson-distribution" class="section level3 tabset">
<h3><span class="header-section-number">3.1.1</span> Poisson Distribution</h3>
<p>This sections shows how to compute and graph probability mass and distribution functions for the Poisson distribution.</p>
<div id="probability-mass-function-pmf" class="section level4">
<h4><span class="header-section-number">3.1.1.1</span> Probability Mass Function (pmf)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lambda &lt;-<span class="st"> </span><span class="dv">3</span>
N&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>, <span class="dv">1</span>)
<span class="co">#get the probability mass function using &quot;dpois&quot;</span>
(fn &lt;-<span class="st"> </span><span class="kw">dpois</span>(N, lambda))</code></pre></div>
<pre><code> [1] 4.978707e-02 1.493612e-01 2.240418e-01 2.240418e-01 1.680314e-01
 [6] 1.008188e-01 5.040941e-02 2.160403e-02 8.101512e-03 2.700504e-03
[11] 8.101512e-04 2.209503e-04 5.523758e-05 1.274713e-05 2.731529e-06
[16] 5.463057e-07 1.024323e-07 1.807629e-08 3.012715e-09 4.756919e-10
[21] 7.135379e-11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize the probability mass function </span>
<span class="kw">plot</span>(N,fn,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;f(n)&quot;</span>) </code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>A few quick notes on these commands.</p>
<ul>
<li><a href="javascript://"  title="" data-toggle="popover" data-placement="top" data-trigger="hover" data-content="The assignment operator  is analogous to an equal sign in mathematics.", style="color:green;"><code>&lt;-</code></a></li>
<li><code>seq</code> is short-hand for sequence.</li>
<li><code>dpois</code> is a built-in command in <strong>R</strong> for generating the “density” (actually the mass) function of the Poisson distribution. Use the online help (<code>help(&quot;dpois&quot;)</code>) to learn more about this function.</li>
<li>The open paren <code>(</code>, close paren <code>)</code> tells <strong>R</strong> to display the output of a calculation to the screen.</li>
<li><code>plot</code> is a very handy command for displaying results graphically.</li>
</ul>
</div>
<div id="cumulative-probability-distribution-function-cdf" class="section level4">
<h4><span class="header-section-number">3.1.1.2</span> (Cumulative) Probability Distribution Function (cdf)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#get the cumulative distribution function using &quot;ppois&quot;</span>
(Fn &lt;-<span class="st"> </span><span class="kw">ppois</span>(N, lambda) )</code></pre></div>
<pre><code> [1] 0.04978707 0.19914827 0.42319008 0.64723189 0.81526324 0.91608206
 [7] 0.96649146 0.98809550 0.99619701 0.99889751 0.99970766 0.99992861
[13] 0.99998385 0.99999660 0.99999933 0.99999988 0.99999998 1.00000000
[19] 1.00000000 1.00000000 1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize the cumulative distribution function</span>
<span class="kw">plot</span>(N,Fn,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;F(n)&quot;</span>) <span class="co"># cdf</span></code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="negative-binomial-distribution" class="section level3 tabset">
<h3><span class="header-section-number">3.1.2</span> Negative Binomial Distribution</h3>
<p>This section shows how to compute and graph probability mass and distribution functions for the negative binomial distribution. You will also learn how to plot two functions on the same graph.</p>
<div id="probability-mass-function-pmf-1" class="section level4 tabset">
<h4><span class="header-section-number">3.1.2.1</span> Probability Mass Function (pmf)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alpha&lt;-<span class="st"> </span><span class="dv">3</span>
theta&lt;-<span class="st"> </span><span class="dv">2</span>
prob&lt;-<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>theta)
N&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>, <span class="dv">1</span>)
<span class="co">#get the probability mass function using &quot;dnbinom&quot;</span>
(fn &lt;-<span class="st"> </span><span class="kw">dnbinom</span>(N, alpha,prob) )</code></pre></div>
<pre><code> [1] 3.703704e-02 7.407407e-02 9.876543e-02 1.097394e-01 1.097394e-01
 [6] 1.024234e-01 9.104303e-02 7.803688e-02 6.503074e-02 5.298801e-02
[11] 4.239041e-02 3.339850e-02 2.597661e-02 1.998201e-02 1.522439e-02
[16] 1.150287e-02 8.627153e-03 6.428075e-03 4.761537e-03 3.508501e-03
[21] 2.572901e-03 1.878626e-03 1.366273e-03 9.900532e-04 7.150384e-04
[26] 5.148277e-04 3.696199e-04 2.646661e-04 1.890472e-04 1.347233e-04
[31] 9.580323e-05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualize the probability mass function</span>
<span class="kw">plot</span>(N,fn,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;f(n)&quot;</span>) <span class="co"># pmf</span></code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;" /></p>
<div id="plot-two-functions-on-the-same-graph" class="section level5">
<h5><span class="header-section-number">3.1.2.1.1</span> Plot Two Functions on The Same Graph</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Plot Different Negative Binomial Distributions on the same Figure</span>
alpha1 &lt;-<span class="st"> </span><span class="dv">3</span>
alpha2 &lt;-<span class="st"> </span><span class="dv">5</span>
theta &lt;-<span class="st"> </span><span class="dv">2</span>; prob &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>theta)
fn1 &lt;-<span class="st"> </span><span class="kw">dnbinom</span>(N, alpha1,prob)
fn2 &lt;-<span class="st"> </span><span class="kw">dnbinom</span>(N, alpha2,prob)
<span class="kw">plot</span>(N,fn1,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;f(n)&quot;</span>)
<span class="kw">lines</span>(N,fn2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">type=</span><span class="st">&quot;p&quot;</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-16-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>A couple notes on these commands:</p>
<ul>
<li>You can enter more than one command on a line; separate them using the <code>;</code> semi-colon.</li>
<li><code>lines</code> is very handy for superimposing one graph on another.</li>
<li>When making complex graphs with more than one function, consider using different colors. The <code>col=&quot;red&quot;</code> tells <strong>R</strong> to use the color red when plotting symbols.</li>
</ul>
</div>
</div>
<div id="cumulative-probability-distribution-function-cdf-1" class="section level4">
<h4><span class="header-section-number">3.1.2.2</span> (Cumulative) Probability Distribution Function (cdf)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#get the distribution function using &quot;pnbinom&quot;</span>
(Fn &lt;-<span class="st"> </span><span class="kw">pnbinom</span>(N, alpha,prob))</code></pre></div>
<pre><code> [1] 0.03703704 0.11111111 0.20987654 0.31961591 0.42935528 0.53177869
 [7] 0.62282172 0.70085861 0.76588935 0.81887735 0.86126776 0.89466626
[13] 0.92064288 0.94062489 0.95584927 0.96735214 0.97597930 0.98240737
[19] 0.98716891 0.99067741 0.99325031 0.99512894 0.99649521 0.99748526
[25] 0.99820030 0.99871513 0.99908475 0.99934942 0.99953846 0.99967319
[31] 0.99976899</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(N,Fn,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;F(n)&quot;</span>) <span class="co"># cdf</span></code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="binomial-distribution" class="section level3 tabset">
<h3><span class="header-section-number">3.1.3</span> Binomial Distribution</h3>
<p>This section shows how to compute and graph probability mass and distribution functions for the binomial distribution.</p>
<div id="probability-mass-function-pmf-2" class="section level4">
<h4><span class="header-section-number">3.1.3.1</span> Probability Mass Function (pmf)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Plot Different Binomial Distributions on the same Figure</span>
size&lt;-<span class="st"> </span><span class="dv">30</span>
prob&lt;-<span class="st"> </span><span class="fl">0.6</span>
N&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>, <span class="dv">1</span>)
fn &lt;-<span class="st"> </span><span class="kw">dbinom</span>(N,size ,prob)
<span class="kw">plot</span>(N,fn,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;f(n)&quot;</span>) <span class="co"># pdf</span>
fn2 &lt;-<span class="st"> </span><span class="kw">dbinom</span>(N,size ,<span class="fl">0.7</span>)
<span class="kw">lines</span>(N,fn2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">type=</span><span class="st">&quot;p&quot;</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-18-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="cumulative-probability-distribution-function-cdf-2" class="section level4">
<h4><span class="header-section-number">3.1.3.2</span> (Cumulative) Probability Distribution Function (cdf)</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#get the distribution function using &quot;pbinom&quot;</span>
(Fn &lt;-<span class="st"> </span><span class="kw">pbinom</span>(N, size,prob))</code></pre></div>
<pre><code> [1] 1.152922e-12 5.303439e-11 1.181456e-09 1.697936e-08 1.769332e-07
 [6] 1.424573e-06 9.222321e-06 4.932503e-05 2.222679e-04 8.563920e-04
[11] 2.853883e-03 8.301584e-03 2.123988e-02 4.811171e-02 9.705684e-02
[16] 1.753691e-01 2.854956e-01 4.215343e-01 5.689095e-01 7.085281e-01
[21] 8.237135e-01 9.059888e-01 9.564759e-01 9.828170e-01 9.943412e-01
[26] 9.984899e-01 9.996867e-01 9.999526e-01 9.999954e-01 9.999998e-01
[31] 1.000000e+00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(N,Fn,<span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;F(n)&quot;</span>) <span class="co"># cdf</span></code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-19-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="ab0-class-of-distributions" class="section level2 tabset">
<h2><span class="header-section-number">3.2</span> (<em>a</em>,<em>b</em>,0) Class of Distributions</h2>
<p>This section shows how to compute recursively a distribution in the (<em>a</em>,<em>b</em>,0) class. The specific example is a Poisson. However, by changing values of <em>a</em> and <em>b</em>, you can use the same recursion for negative binomial and binomial, the other two members of the (<em>a</em>,<em>b</em>,0) class.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lambda&lt;-<span class="dv">3</span>
a&lt;-<span class="dv">0</span>
b&lt;-lambda
<span class="co">#This loop calculates the (a,b,0) recursive probabilities for the Poisson distribution</span>
p &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">20</span>)
<span class="co"># Get the probability at n=0 to start the recursive formula </span>
p[<span class="dv">1</span>]&lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>lambda)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">19</span>)
  {
  p[i<span class="op">+</span><span class="dv">1</span>]&lt;-(a<span class="op">+</span>b<span class="op">/</span>i)<span class="op">*</span>p[i]         <span class="co"># Probability of i-th element using the ab0 formula</span>
  }
p</code></pre></div>
<pre><code> [1] 4.978707e-02 1.493612e-01 2.240418e-01 2.240418e-01 1.680314e-01
 [6] 1.008188e-01 5.040941e-02 2.160403e-02 8.101512e-03 2.700504e-03
[11] 8.101512e-04 2.209503e-04 5.523758e-05 1.274713e-05 2.731529e-06
[16] 5.463057e-07 1.024323e-07 1.807629e-08 3.012715e-09 4.756919e-10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># check using the &quot;dpois&quot; command</span>
<span class="kw">dpois</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>, <span class="dv">1</span>), <span class="dt">lambda=</span><span class="dv">3</span>)</code></pre></div>
<pre><code> [1] 4.978707e-02 1.493612e-01 2.240418e-01 2.240418e-01 1.680314e-01
 [6] 1.008188e-01 5.040941e-02 2.160403e-02 8.101512e-03 2.700504e-03
[11] 8.101512e-04 2.209503e-04 5.523758e-05 1.274713e-05 2.731529e-06
[16] 5.463057e-07 1.024323e-07 1.807629e-08 3.012715e-09 4.756919e-10
[21] 7.135379e-11</code></pre>
<p>A couple notes on these commands.</p>
<ul>
<li>There are many basic math commands in <strong>R</strong> such as <code>exp</code> for exponentials.</li>
<li>This demo illustrates the use of the <code>for</code> loop, one of many ways of doing recursive calculations.</li>
</ul>
</div>
<div id="estimating-frequency-distributions" class="section level2 tabset">
<h2><span class="header-section-number">3.3</span> Estimating Frequency Distributions</h2>
<div id="singapore-data" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Singapore Data</h3>
<p>This section loads the <code>SingaporeAuto.csv</code> dataset and checks the names of variables and the dimensions of the data. To have a glimpse at the data, the first 8 observations are listed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Singapore =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Data/SingaporeAuto.csv&quot;</span>,  <span class="dt">quote =</span> <span class="st">&quot;&quot;</span>,<span class="dt">header=</span><span class="ot">TRUE</span>)
<span class="co">#  Check the names, dimensions in the file and list the first 8 observations ;</span>
<span class="kw">names</span>(Singapore)</code></pre></div>
<pre><code> [1] &quot;SexInsured&quot;  &quot;Female&quot;      &quot;VehicleType&quot; &quot;PC&quot;          &quot;Clm_Count&quot;  
 [6] &quot;Exp_weights&quot; &quot;LNWEIGHT&quot;    &quot;NCD&quot;         &quot;AgeCat&quot;      &quot;AutoAge0&quot;   
[11] &quot;AutoAge1&quot;    &quot;AutoAge2&quot;    &quot;AutoAge&quot;     &quot;VAgeCat&quot;     &quot;VAgecat1&quot;   </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(Singapore)  <span class="co"># check number of observations and variables in the data</span></code></pre></div>
<pre><code>[1] 7483   15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Singapore[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,]  <span class="co"># list the first 4 observations</span></code></pre></div>
<pre><code>  SexInsured Female VehicleType PC Clm_Count Exp_weights    LNWEIGHT NCD
1          U      0           T  0         0   0.6680356 -0.40341383  30
2          U      0           T  0         0   0.5667351 -0.56786326  30
3          U      0           T  0         0   0.5037645 -0.68564629  30
4          U      0           T  0         0   0.9144422 -0.08944106  20
  AgeCat AutoAge0 AutoAge1 AutoAge2 AutoAge VAgeCat VAgecat1
1      0        0        0        0       0       0        2
2      0        0        0        0       0       0        2
3      0        0        0        0       0       0        2
4      0        0        0        0       0       0        2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(Singapore)  <span class="co"># attach dataset</span></code></pre></div>
<p>A few quick notes on these commands:</p>
<ul>
<li><a href="javascript://" title="" data-toggle="popover" data-placement="top" data-trigger="hover" data-content="Function used to get or assign names of an object. In this illustration, it was used to get the variables names.", style="color:green;"><code>names()</code></a></li>
<li>The <code>dim()</code> function is used to retrieve or set the dimensions of an object.</li>
<li>When you attach a dataset using the <code>attach()</code> function, variable names in the database can be accessed by simply giving their names.</li>
</ul>
</div>
<div id="claim-frequency-distribution-1" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Claim Frequency Distribution</h3>
<p>The table below gives the distribution of observed claims frequency. The <code>Clm_Count</code> variable is the number of automobile accidents per policyholder.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(Clm_Count) </code></pre></div>
<pre><code>Clm_Count
   0    1    2    3 
6996  455   28    4 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(n &lt;-<span class="st"> </span><span class="kw">length</span>(Clm_Count))  <span class="co"># number of insurance policies </span></code></pre></div>
<pre><code>[1] 7483</code></pre>
</div>
<div id="visualize-the-loglikelihood-function" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Visualize The Loglikelihood Function</h3>
<p>Before maximizing, let us start by visualizing the logarithmic <a href="javascript://" title="" data-toggle="popover" data-placement="top" data-trigger="hover" data-content="A function of the parameters with the data fixed rather than a function of the data with the parameters fixed.", style="color:green;">likelihood function</a>. We will fit the claim counts for the Singapore data to the Poisson model. As an illustration, first assume that <span class="math inline">\(\lambda = 0.5\)</span>. The claim count, likelihood, and its logarithmic version, for five observations is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  Five typical Observations</span>
Clm_Count[<span class="dv">2245</span><span class="op">:</span><span class="dv">2249</span>]</code></pre></div>
<pre><code>[1] 3 0 1 0 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Probabilities</span>
<span class="kw">dpois</span>(Clm_Count[<span class="dv">2245</span><span class="op">:</span><span class="dv">2249</span>],<span class="dt">lambda=</span><span class="fl">0.5</span>)</code></pre></div>
<pre><code>[1] 0.01263606 0.60653066 0.30326533 0.60653066 0.01263606</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Logarithmic Probabilities</span>
<span class="kw">log</span>(<span class="kw">dpois</span>(Clm_Count[<span class="dv">2245</span><span class="op">:</span><span class="dv">2249</span>],<span class="dt">lambda=</span><span class="fl">0.5</span>))</code></pre></div>
<pre><code>[1] -4.371201 -0.500000 -1.193147 -0.500000 -4.371201</code></pre>
<p>By hand, you can check that the sum of log likelihoods for these five observations is -10.9355492. In the same way, the sum of all 7483 observations is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">dpois</span>(Clm_Count,<span class="dt">lambda=</span><span class="fl">0.5</span>)))</code></pre></div>
<pre><code>[1] -4130.591</code></pre>
<p>Of course, this is only for the choice <span class="math inline">\(\lambda = 0.5\)</span>. The following code defines the log likelihood to be a function of <span class="math inline">\(\lambda\)</span> and plots the function for several choices of <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">loglikPois&lt;-<span class="cf">function</span>(parms){ 
  lambda=parms[<span class="dv">1</span>]
  llk &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">dpois</span>(Clm_Count,lambda)))
  llk
} <span class="co"># Defines the (negative) Poisson loglikelihood function</span>
lambdax &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,.<span class="dv">2</span>,.<span class="dv">01</span>)
loglike &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">*</span>lambdax
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(lambdax)) 
  {
  loglike[i] &lt;-<span class="st"> </span><span class="kw">loglikPois</span>(lambdax[i])
}
<span class="kw">plot</span>(lambdax,loglike)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If we had to guess, from this plot we might say that the maximum value of the log likelihood was around 0.07.</p>
</div>
<div id="the-maximum-likelihood-estimate-of-poisson-distribution" class="section level3">
<h3><span class="header-section-number">3.3.4</span> The Maximum Likelihood Estimate of Poisson Distribution</h3>
<p>From calculus, we know that the maximum likelihood estimator <a href="javascript://" title="" data-toggle="popover" data-placement="top" data-trigger="hover" data-content="Values of the parameters that are 'most likely' to have been produced by the data.", style="color:green;">(<em>mle</em>)</a> of the Poisson distribution parameter equals the average claim count. For our data, this is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(Clm_Count)</code></pre></div>
<pre><code>[1] 0.06989175</code></pre>
<p>As an alternative, let us use an optimization routine <code>nlminb</code>. Most optimization routines try to minimize functions instead of maximize them, so we first define the <em>negative</em> loglikelihood function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">negloglikPois&lt;-<span class="cf">function</span>(parms){
  lambda=parms[<span class="dv">1</span>]
  llk &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">dpois</span>(Clm_Count,lambda)))
  llk
} <span class="co"># Defines the (negative) Poisson loglikelihood function</span>
ini.Pois &lt;-<span class="st"> </span><span class="dv">1</span> 
zop.Pois &lt;-<span class="st"> </span><span class="kw">nlminb</span>(ini.Pois,negloglikPois,<span class="dt">lower=</span><span class="kw">c</span>(<span class="fl">1e-6</span>),<span class="dt">upper=</span><span class="kw">c</span>(<span class="ot">Inf</span>))
<span class="kw">print</span>(zop.Pois) <span class="co"># In output, $par = MLE of lambda, $objective = - loglikelihood value</span></code></pre></div>
<pre><code>$par
[1] 0.06989175

$objective
[1] 1941.178

$convergence
[1] 0

$iterations
[1] 17

$evaluations
function gradient 
      23       20 

$message
[1] &quot;relative convergence (4)&quot;</code></pre>
<p>So, the maximum likelihood estimate, <code>zop.Pois$par =</code> 0.0698918 is exactly the same as the value that we got by hand.</p>
<p>Because actuarial analysts calculate Poisson mle’s so regularly, here is another way of doing the calculation using the <code>glm</code>, <em>generalized linear model</em>, package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">CountPoisson1 =<span class="st"> </span><span class="kw">glm</span>(Clm_Count <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,<span class="kw">poisson</span>(<span class="dt">link=</span>log))
<span class="kw">summary</span>(CountPoisson1)</code></pre></div>
<pre><code>
Call:
glm(formula = Clm_Count ~ 1, family = poisson(link = log))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.3739  -0.3739  -0.3739  -0.3739   4.0861  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -2.66081    0.04373  -60.85   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2887.2  on 7482  degrees of freedom
Residual deviance: 2887.2  on 7482  degrees of freedom
AIC: 3884.4

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(lambda_hat&lt;-<span class="kw">exp</span>(CountPoisson1<span class="op">$</span>coefficients))</code></pre></div>
<pre><code>(Intercept) 
 0.06989175 </code></pre>
<p>A few quick notes on these commands and results:</p>
<ul>
<li>The <code>glm()</code>function is used to fit generalized linear models. See <code>help(glm)</code> for other modeling options. In order to get the results we use the <code>summary()</code> function.</li>
<li>In the output, <code>call</code> reminds us what model we ran and what options were specified.</li>
<li>The <code>Deviance Residuals</code> shows the distribution of the deviance residuals for individual cases used in the model.</li>
<li>The next part of the output shows the coefficient (maximum likelihood estimate of <span class="math inline">\(\log(\lambda)\)</span>), its standard error, the z-statistic and the associated p-value.</li>
<li>To get the estimated <span class="math inline">\(\lambda\)</span> we take the <span class="math inline">\(\exp\)</span>(coefficient) <code>lambda_hat&lt;-exp(CountPoisson1$coefficients)</code>.</li>
</ul>
</div>
<div id="the-maximum-likelihood-estimate-of-the-negative-binomial-distribution" class="section level3">
<h3><span class="header-section-number">3.3.5</span> The Maximum Likelihood Estimate of The Negative Binomial Distribution</h3>
<p>In the same way, here is code for determining the maximum likelihood estimates for the negative binomial distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dnb &lt;-<span class="st"> </span><span class="cf">function</span>(y,r,beta){
  <span class="kw">gamma</span>(y<span class="op">+</span>r)<span class="op">/</span><span class="kw">gamma</span>(r)<span class="op">/</span><span class="kw">gamma</span>(y<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>beta))<span class="op">^</span>r<span class="op">*</span>(beta<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>beta))<span class="op">^</span>y
}
loglikNB&lt;-<span class="cf">function</span>(parms){ 
  r=parms[<span class="dv">1</span>]
  beta=parms[<span class="dv">2</span>]
  llk &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">dnb</span>(Clm_Count,r,beta)))
  llk
} <span class="co"># Defines the (negative) negative binomial loglikelihood function</span>

ini.NB &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)
zop.NB &lt;-<span class="st"> </span><span class="kw">nlminb</span>(ini.NB,loglikNB,<span class="dt">lower=</span><span class="kw">c</span>(<span class="fl">1e-6</span>,<span class="fl">1e-6</span>),<span class="dt">upper=</span><span class="kw">c</span>(<span class="ot">Inf</span>,<span class="ot">Inf</span>))
<span class="kw">print</span>(zop.NB) <span class="co"># In output, $par = (MLE of r, MLE of beta), $objective = - loglikelihood value</span></code></pre></div>
<pre><code>$par
[1] 0.87401622 0.07996624

$objective
[1] 1932.383

$convergence
[1] 0

$iterations
[1] 24

$evaluations
function gradient 
      30       60 

$message
[1] &quot;relative convergence (4)&quot;</code></pre>
<p>Two quick notes:</p>
<ul>
<li>There are two parameters for this distribution, so that calculation by hand is not a good alternative.</li>
<li>The maximum likelihood estimator of <em>r</em>, 0.8740162, is not an integer.</li>
</ul>
</div>
</div>
<div id="goodness-of-fit" class="section level2 tabset">
<h2><span class="header-section-number">3.4</span> Goodness of Fit</h2>
<p>This section shows how to check the adequacy of the Poisson and negative binomial models for the Singapore data.</p>
<p>First, note that the variance for the <em>count</em> data is 0.0757079 which is greater than the mean value, 0.0698918. This suggests that the negative binomial model is preferred to the Poisson model.</p>
<p>Second, we will compute the <em>Pearson goodness-of-fit statistic</em>.</p>
<div id="pearson-goodness-of-fit-statistic" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Pearson Goodness-of-Fit Statistic</h3>
<p>The table below gives the distribution of fitted claims frequency using Poisson distribution <span class="math inline">\(n \times p_k\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table1p =<span class="st"> </span><span class="kw">cbind</span>(n<span class="op">*</span>(<span class="kw">dpois</span>(<span class="dv">0</span>,lambda_hat)),
                n<span class="op">*</span>(<span class="kw">dpois</span>(<span class="dv">1</span>,lambda_hat)),
                n<span class="op">*</span>(<span class="kw">dpois</span>(<span class="dv">2</span>,lambda_hat)),
                n<span class="op">*</span>(<span class="kw">dpois</span>(<span class="dv">3</span>,lambda_hat)),
                n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">ppois</span>(<span class="dv">3</span>,lambda_hat))) <span class="co"># or n*(1-dpois(0,lambda_hat)-dpois(1,lambda_hat)-</span>
                                       <span class="co">#     dpois(2,lambda_hat)-dpois(3,lambda_hat)))</span>
actual =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">table</span>(Clm_Count))[,<span class="dv">2</span>];
actual[<span class="dv">5</span>] =<span class="st"> </span><span class="dv">0</span>  <span class="co"># assign 0 to claim counts greater than or equal to 4 in observed data</span>

table2p&lt;-<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="st">&quot;4+&quot;</span>),actual,<span class="kw">round</span>(table1p, <span class="dt">digits =</span> <span class="dv">2</span>))
<span class="kw">rownames</span>(table2p) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Number&quot;</span>,<span class="st">&quot;Actual&quot;</span>, <span class="st">&quot;Estimated Using Poisson&quot;</span>)
table2p</code></pre></div>
<pre><code>                        [,1]      [,2]     [,3]    [,4]  [,5]  
Number                  &quot;0&quot;       &quot;1&quot;      &quot;2&quot;     &quot;3&quot;   &quot;4+&quot;  
Actual                  &quot;6996&quot;    &quot;455&quot;    &quot;28&quot;    &quot;4&quot;   &quot;0&quot;   
Estimated Using Poisson &quot;6977.86&quot; &quot;487.69&quot; &quot;17.04&quot; &quot;0.4&quot; &quot;0.01&quot;</code></pre>
<p>For goodness of fit, consider Pearson’s chi-square statistic below. The degrees of freedom (<em>df</em>) equals the number of cells minus one minus the number of estimated parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  PEARSON GOODNESS-OF-FIT STATISTIC</span>
diff =<span class="st"> </span>actual<span class="op">-</span>table1p
(<span class="dt">Pearson_p =</span> <span class="kw">sum</span>(diff<span class="op">*</span>diff<span class="op">/</span>table1p))</code></pre></div>
<pre><code>[1] 41.98438</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  p-value</span>
<span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(Pearson_p, <span class="dt">df=</span><span class="dv">5</span><span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">1</span>)</code></pre></div>
<pre><code>[1] 4.042861e-09</code></pre>
<p>The large value of the goodness of fit statistic 41.984382 or the small <em>p</em> value indicates that there is a large difference between actual counts and those anticipated under the Poisson model.</p>
</div>
<div id="negative-binomial-goodness-of-fit-statistic" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Negative Binomial Goodness-of-Fit Statistic</h3>
<p>Here is another way of determining the maximum likelihood estimator of the negative binomial distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
fm_nb &lt;-<span class="st"> </span><span class="kw">glm.nb</span>(Clm_Count<span class="op">~</span><span class="dv">1</span>,<span class="dt">link=</span>log)
<span class="kw">summary</span>(fm_nb)</code></pre></div>
<pre><code>
Call:
glm.nb(formula = Clm_Count ~ 1, link = log, init.theta = 0.8740189897)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.3667  -0.3667  -0.3667  -0.3667   3.4082  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -2.66081    0.04544  -58.55   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for Negative Binomial(0.874) family taken to be 1)

    Null deviance: 2435.5  on 7482  degrees of freedom
Residual deviance: 2435.5  on 7482  degrees of freedom
AIC: 3868.8

Number of Fisher Scoring iterations: 1

              Theta:  0.874 
          Std. Err.:  0.276 

 2 x log-likelihood:  -3864.767 </code></pre>
<p>With these new estimates (or you could use the general procedure we introduced earlier), we can produce a table of counts and fitted counts and use this to calculate the goodness-of-fit statistic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fm_nb<span class="op">$</span>theta</code></pre></div>
<pre><code>[1] 0.874019</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beta &lt;-<span class="st"> </span><span class="kw">exp</span>(fm_nb<span class="op">$</span>coefficients)<span class="op">/</span>fm_nb<span class="op">$</span>theta
prob &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>beta)

table1nb =<span class="st"> </span><span class="kw">cbind</span>(n<span class="op">*</span>(<span class="kw">dnbinom</span>(<span class="dv">0</span>,<span class="dt">size=</span>fm_nb<span class="op">$</span>theta,prob)),
                n<span class="op">*</span>(<span class="kw">dnbinom</span>(<span class="dv">1</span>,<span class="dt">size=</span>fm_nb<span class="op">$</span>theta,prob)),
                n<span class="op">*</span>(<span class="kw">dnbinom</span>(<span class="dv">2</span>,<span class="dt">size=</span>fm_nb<span class="op">$</span>theta,prob)),
                n<span class="op">*</span>(<span class="kw">dnbinom</span>(<span class="dv">3</span>,<span class="dt">size=</span>fm_nb<span class="op">$</span>theta,prob)),
                n<span class="op">*</span>(<span class="kw">dnbinom</span>(<span class="dv">4</span>,<span class="dt">size=</span>fm_nb<span class="op">$</span>theta,prob)));
table2nb&lt;-<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="st">&quot;4+&quot;</span>),actual,<span class="kw">round</span>(table1nb, <span class="dt">digits =</span> <span class="dv">2</span>))
<span class="kw">rownames</span>(table2nb) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Number&quot;</span>,<span class="st">&quot;Actual&quot;</span>, <span class="st">&quot;Estimated Using Neg Bin&quot;</span>)
table2nb</code></pre></div>
<pre><code>                        [,1]     [,2]     [,3]    [,4]   [,5]  
Number                  &quot;0&quot;      &quot;1&quot;      &quot;2&quot;     &quot;3&quot;    &quot;4+&quot;  
Actual                  &quot;6996&quot;   &quot;455&quot;    &quot;28&quot;    &quot;4&quot;    &quot;0&quot;   
Estimated Using Neg Bin &quot;6996.4&quot; &quot;452.78&quot; &quot;31.41&quot; &quot;2.23&quot; &quot;0.16&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  PEARSON GOODNESS-OF-FIT STATISTIC</span>
diff =<span class="st"> </span>actual<span class="op">-</span>table1nb
(  <span class="dt">Pearson_nb =</span> <span class="kw">sum</span>(diff<span class="op">*</span>diff<span class="op">/</span>table1nb) )</code></pre></div>
<pre><code>[1] 1.95024</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  p-value</span>
<span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(Pearson_nb, <span class="dt">df=</span><span class="dv">5</span><span class="op">-</span><span class="dv">2</span><span class="op">-</span><span class="dv">1</span>)</code></pre></div>
<pre><code>[1] 0.3771472</code></pre>
<p>The small value of the goodness of fit statistic 1.9502395 or the high <em>p</em> value 0.3771472 both indicate that the negative binomial provides a better fit to the data than the Poisson.</p>
<script>
$(document).ready(function(){
    $('[data-toggle="popover"]').popover(); 
});
</script>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-loss-data-analytics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-loss-severities.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["R for Loss Data Analytics.pdf", "R for Loss Data Analytics.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
