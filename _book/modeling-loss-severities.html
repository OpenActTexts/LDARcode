<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Loss Data Analytics</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown 0.6.2 and GitBook 2.6.7">

  <meta property="og:title" content="R for Loss Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Loss Data Analytics" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Jed Frees">


<meta name="date" content="2018-04-06">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="frequency-distributions.html">
<link rel="next" href="model-selection.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />








<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan, pre.js');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}
.open > .dropdown-menu {
    display: block;
}
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<script>
document.write('<div class="btn-group pull-right" style="position: absolute; top: 20%; right: 2%; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>')
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Loss Data Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to Loss Data Analytics</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#case-study-wisconsin-property-fund"><i class="fa fa-check"></i><b>1.1</b> Case Study: Wisconsin Property Fund</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#read-in-property-fund-data"><i class="fa fa-check"></i><b>1.1.1</b> Read in Property Fund Data</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#claim-frequency-distribution"><i class="fa fa-check"></i><b>1.1.2</b> Claim Frequency Distribution</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#average-severity-distribution-for-2010"><i class="fa fa-check"></i><b>1.1.3</b> Average Severity Distribution for 2010</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#plot-of-average-claims"><i class="fa fa-check"></i><b>1.1.4</b> Plot of average claims</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#rating-variables"><i class="fa fa-check"></i><b>1.2</b> Rating Variables</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#average-claims-over-time"><i class="fa fa-check"></i><b>1.2.1</b> Average claims over time</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#frequency-and-claims-statistics-of-full-data"><i class="fa fa-check"></i><b>1.2.2</b> Frequency and claims statistics of full data</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#rating-variable-description"><i class="fa fa-check"></i><b>1.2.3</b> Rating variable description</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#frequency-and-claims-by-rating-variables"><i class="fa fa-check"></i><b>1.2.4</b> Frequency and claims by rating variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="frequency-distributions.html"><a href="frequency-distributions.html"><i class="fa fa-check"></i><b>2</b> Frequency Distributions</a><ul>
<li class="chapter" data-level="2.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#basic-distributions"><i class="fa fa-check"></i><b>2.1</b> Basic Distributions</a><ul>
<li class="chapter" data-level="2.1.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#poisson-distribution"><i class="fa fa-check"></i><b>2.1.1</b> Poisson Distribution</a></li>
<li class="chapter" data-level="2.1.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>2.1.2</b> Negative Binomial Distribution</a></li>
<li class="chapter" data-level="2.1.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>2.1.3</b> Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#ab0-class-of-distributions"><i class="fa fa-check"></i><b>2.2</b> (<em>a</em>,<em>b</em>,0) Class of Distributions</a></li>
<li class="chapter" data-level="2.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#estimating-frequency-distributions"><i class="fa fa-check"></i><b>2.3</b> Estimating Frequency Distributions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#singapore-data"><i class="fa fa-check"></i><b>2.3.1</b> Singapore Data</a></li>
<li class="chapter" data-level="2.3.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#claim-frequency-distribution-1"><i class="fa fa-check"></i><b>2.3.2</b> Claim frequency distribution</a></li>
<li class="chapter" data-level="2.3.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#visualize-the-loglikelihood-function"><i class="fa fa-check"></i><b>2.3.3</b> Visualize the Loglikelihood function</a></li>
<li class="chapter" data-level="2.3.4" data-path="frequency-distributions.html"><a href="frequency-distributions.html#the-maximum-likelihood-estimate-of-poisson-distribution"><i class="fa fa-check"></i><b>2.3.4</b> The maximum likelihood estimate of Poisson distribution</a></li>
<li class="chapter" data-level="2.3.5" data-path="frequency-distributions.html"><a href="frequency-distributions.html#the-maximum-likelihood-estimate-of-the-negative-binomial-distribution"><i class="fa fa-check"></i><b>2.3.5</b> The maximum likelihood estimate of the Negative Binomial distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="frequency-distributions.html"><a href="frequency-distributions.html#goodness-of-fit"><i class="fa fa-check"></i><b>2.4</b> Goodness of Fit</a><ul>
<li class="chapter" data-level="2.4.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#pearson-goodness-of-fit-statistic"><i class="fa fa-check"></i><b>2.4.1</b> Pearson goodness-of-fit statistic</a></li>
<li class="chapter" data-level="2.4.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#negative-binomial-goodness-of-fit-statistic"><i class="fa fa-check"></i><b>2.4.2</b> Negative binomial goodness-of-fit statistic</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="frequency-distributions.html"><a href="frequency-distributions.html#singapore-data-1"><i class="fa fa-check"></i><b>2.5</b> Singapore Data</a></li>
<li class="chapter" data-level="2.6" data-path="frequency-distributions.html"><a href="frequency-distributions.html#goodness-of-fit-for-poisson-distribution"><i class="fa fa-check"></i><b>2.6</b> Goodness of fit for Poisson distribution</a><ul>
<li class="chapter" data-level="2.6.1" data-path="frequency-distributions.html"><a href="frequency-distributions.html#claim-frequency-distribution-2"><i class="fa fa-check"></i><b>2.6.1</b> Claim frequency distribution</a></li>
<li class="chapter" data-level="2.6.2" data-path="frequency-distributions.html"><a href="frequency-distributions.html#the-maximum-likelihood-estimate-of-lambda"><i class="fa fa-check"></i><b>2.6.2</b> The maximum likelihood estimate of <span class="math inline">\(\lambda\)</span></a></li>
<li class="chapter" data-level="2.6.3" data-path="frequency-distributions.html"><a href="frequency-distributions.html#pearson-goodness-of-fit-statistic-1"><i class="fa fa-check"></i><b>2.6.3</b> Pearson goodness-of-fit statistic</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html"><i class="fa fa-check"></i><b>3</b> Modeling Loss Severities</a><ul>
<li class="chapter" data-level="3.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#required-packages"><i class="fa fa-check"></i><b>3.1</b> Required packages</a></li>
<li class="chapter" data-level="3.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#gamma-distribution"><i class="fa fa-check"></i><b>3.2</b> Gamma Distribution</a><ul>
<li class="chapter" data-level="3.2.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-shape-parameter"><i class="fa fa-check"></i><b>3.2.1</b> Varying the shape parameter</a></li>
<li class="chapter" data-level="3.2.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-scale-parameter"><i class="fa fa-check"></i><b>3.2.2</b> Varying the scale parameter</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#pareto-distribution"><i class="fa fa-check"></i><b>3.3</b> Pareto Distribution</a><ul>
<li class="chapter" data-level="3.3.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-shape-parameter-1"><i class="fa fa-check"></i><b>3.3.1</b> Varying the shape parameter</a></li>
<li class="chapter" data-level="3.3.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-scale-parameter-1"><i class="fa fa-check"></i><b>3.3.2</b> Varying the scale parameter</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#weibull-distribution"><i class="fa fa-check"></i><b>3.4</b> Weibull Distribution</a><ul>
<li class="chapter" data-level="3.4.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-shape-parameter-2"><i class="fa fa-check"></i><b>3.4.1</b> Varying the shape parameter</a></li>
<li class="chapter" data-level="3.4.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-scale-parameter-2"><i class="fa fa-check"></i><b>3.4.2</b> Varying the scale parameter</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#the-generalized-beta-distribution-of-the-second-kind-gb2"><i class="fa fa-check"></i><b>3.5</b> The Generalized Beta Distribution of the Second Kind (GB2)</a><ul>
<li class="chapter" data-level="3.5.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#varying-the-scale-parameter-3"><i class="fa fa-check"></i><b>3.5.1</b> Varying the scale parameter</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#methods-of-creating-new-distributions"><i class="fa fa-check"></i><b>3.6</b> Methods of creating new distributions</a><ul>
<li class="chapter" data-level="3.6.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#mixture-distributions"><i class="fa fa-check"></i><b>3.6.1</b> Mixture distributions</a></li>
<li class="chapter" data-level="3.6.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#density-obtained-through-splicing"><i class="fa fa-check"></i><b>3.6.2</b> Density obtained through splicing</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#coverage-modifications"><i class="fa fa-check"></i><b>3.7</b> Coverage Modifications</a><ul>
<li class="chapter" data-level="3.7.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#load-required-package"><i class="fa fa-check"></i><b>3.7.1</b> Load required package</a></li>
<li class="chapter" data-level="3.7.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#ordinary-deductible"><i class="fa fa-check"></i><b>3.7.2</b> Ordinary deductible</a></li>
<li class="chapter" data-level="3.7.3" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#franchise-deductible"><i class="fa fa-check"></i><b>3.7.3</b> Franchise deductible</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#mle-for-grouped-data"><i class="fa fa-check"></i><b>3.8</b> MLE for grouped data</a><ul>
<li class="chapter" data-level="3.8.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#mle-for-grouped-data--soa-exam-c-276"><i class="fa fa-check"></i><b>3.8.1</b> MLE for grouped data- SOA Exam C # 276</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#nonparametric-inference"><i class="fa fa-check"></i><b>3.9</b> Nonparametric Inference</a><ul>
<li class="chapter" data-level="3.9.1" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#nonparametric-estimation-tools"><i class="fa fa-check"></i><b>3.9.1</b> Nonparametric Estimation Tools</a></li>
<li class="chapter" data-level="3.9.2" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#property-fund-data"><i class="fa fa-check"></i><b>3.9.2</b> Property Fund Data</a></li>
<li class="chapter" data-level="3.9.3" data-path="modeling-loss-severities.html"><a href="modeling-loss-severities.html#nonparametric-estimation-tools-for-model-selection"><i class="fa fa-check"></i><b>3.9.3</b> Nonparametric Estimation Tools For Model Selection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="model-selection.html"><a href="model-selection.html"><i class="fa fa-check"></i><b>4</b> Model Selection</a><ul>
<li class="chapter" data-level="4.1" data-path="model-selection.html"><a href="model-selection.html#claim-level-data-of-property-fund"><i class="fa fa-check"></i><b>4.1</b> Claim level data of Property Fund</a><ul>
<li class="chapter" data-level="4.1.1" data-path="model-selection.html"><a href="model-selection.html#claims-data"><i class="fa fa-check"></i><b>4.1.1</b> Claims data</a></li>
<li class="chapter" data-level="4.1.2" data-path="model-selection.html"><a href="model-selection.html#summary-of-claims"><i class="fa fa-check"></i><b>4.1.2</b> Summary of claims</a></li>
<li class="chapter" data-level="4.1.3" data-path="model-selection.html"><a href="model-selection.html#plot-of-claims"><i class="fa fa-check"></i><b>4.1.3</b> Plot of claims</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="model-selection.html"><a href="model-selection.html#fitting-distributions"><i class="fa fa-check"></i><b>4.2</b> Fitting distributions</a><ul>
<li class="chapter" data-level="4.2.1" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-a-lognormal-distribution"><i class="fa fa-check"></i><b>4.2.1</b> Inference assuming a lognormal distribution</a></li>
<li class="chapter" data-level="4.2.2" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-a-gamma-distribution"><i class="fa fa-check"></i><b>4.2.2</b> Inference assuming a gamma distribution</a></li>
<li class="chapter" data-level="4.2.3" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-a-pareto-distribution"><i class="fa fa-check"></i><b>4.2.3</b> Inference assuming a Pareto Distribution</a></li>
<li class="chapter" data-level="4.2.4" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-an-exponential-distribution"><i class="fa fa-check"></i><b>4.2.4</b> Inference assuming an exponential distribution</a></li>
<li class="chapter" data-level="4.2.5" data-path="model-selection.html"><a href="model-selection.html#inference-assuming-an-exponential-distribution-1"><i class="fa fa-check"></i><b>4.2.5</b> Inference assuming an exponential distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="model-selection.html"><a href="model-selection.html#plotting-the-fit-using-densities-on-a-logarithmic-scale"><i class="fa fa-check"></i><b>4.3</b> Plotting the fit using densities (on a logarithmic scale)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>5</b> Simulation</a><ul>
<li class="chapter" data-level="5.1" data-path="simulation.html"><a href="simulation.html#simulation---inversion-method"><i class="fa fa-check"></i><b>5.1</b> Simulation - Inversion method</a></li>
<li class="chapter" data-level="5.2" data-path="simulation.html"><a href="simulation.html#comparing-moments-from-the-simulated-data-to-theoretical-moments"><i class="fa fa-check"></i><b>5.2</b> Comparing moments from the simulated data to theoretical moments</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Loss Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling-loss-severities" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Modeling Loss Severities</h1>
<p><em>This file contains illustrative <strong>R</strong> code for computing important count distributions. When reviewing this code, you should open an <strong>R</strong> session, copy-and-paste the code, and see it perform. Then, you will be able to change parameters, look up commands, and so forth, as you go. </em></p>
<div id="required-packages" class="section level2">
<h2><span class="header-section-number">3.1</span> Required packages</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(actuar)
<span class="kw">library</span>(VGAM)</code></pre></div>
</div>
<div id="gamma-distribution" class="section level2 tabset">
<h2><span class="header-section-number">3.2</span> Gamma Distribution</h2>
<p>This section demonstrates the effect of the shape and scale parameters on the gamma density.</p>
<div id="varying-the-shape-parameter" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Varying the shape parameter</h3>
<p>The graph shows the Gamma density functions with varying shape parameters <span class="math inline">\((\alpha)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Example 1: gamma distribution</span>
<span class="co"># define a grid</span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>,<span class="dt">by=</span><span class="dv">1</span>)

<span class="co"># define a set of scale and shape parameters</span>
scaleparam &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">100</span>,<span class="dv">250</span>,<span class="dt">by=</span><span class="dv">50</span>)
shapeparam &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">5</span>

<span class="co"># varying the shape parameter</span>
<span class="kw">plot</span>(x, <span class="kw">dgamma</span>(x, <span class="dt">shape =</span> shapeparam[<span class="dv">1</span>], <span class="dt">scale =</span> <span class="dv">100</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Gamma density&quot;</span>)

<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(shapeparam)){
  <span class="kw">lines</span>(x,<span class="kw">dgamma</span>(x,<span class="dt">shape =</span> shapeparam[k], <span class="dt">scale =</span> <span class="dv">100</span>), <span class="dt">col =</span> k)
}
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=2&#39;</span>), <span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=3&#39;</span>), <span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=4&#39;</span>), <span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=5&#39;</span>)), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
<span class="kw">title</span>(<span class="kw">substitute</span>(<span class="kw">paste</span>(<span class="st">&quot;Pdf gamma density with&quot;</span>,<span class="st">&quot; &quot;</span>,theta,<span class="st">&quot;=100&quot;</span>,<span class="st">&quot; &quot;</span>, <span class="st">&quot;and varying shape&quot;</span>)))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>A few quick notes on these commands :</p>
<ul>
<li><code>dgamma</code> function is used for density of the Gamma distribution with shape and scale parameters .</li>
<li><p>The <code>legend</code> function can be used to add legends to plots.</p></li>
<li><p><a href="#" title="" data-toggle="popover" data-trigger="hover" data-content="A very handy command for displaying results graphically", style="color:green;"><code>plot</code></a> <a href="#" title="" data-toggle="popover" data-trigger="hover" data-content="Is very handy for superimposing one graph on another", style="color:green;"><code>lines</code></a></p></li>
</ul>
</div>
<div id="varying-the-scale-parameter" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Varying the scale parameter</h3>
<p>The graph shows the Gamma density functions with varying scale parameters <span class="math inline">\((\theta)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x, <span class="kw">dgamma</span>(x, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> scaleparam[<span class="dv">1</span>]), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Gamma density&quot;</span>)

<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(scaleparam)){
  <span class="kw">lines</span>(x,<span class="kw">dgamma</span>(x,<span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">scale =</span> scaleparam[k]), <span class="dt">col =</span> k)
}

<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=100&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=150&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=200&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=250&#39;</span>)), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
<span class="kw">title</span>(<span class="kw">substitute</span>(<span class="kw">paste</span>(<span class="st">&quot;Pdf gamma density with&quot;</span>,<span class="st">&quot; &quot;</span>,alpha,<span class="st">&quot;=2&quot;</span>,<span class="st">&quot; &quot;</span>, <span class="st">&quot;and varying scale&quot;</span>)))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">include_app</span>(<span class="st">&quot;https://luyang.shinyapps.io/gamma/&quot;</span>, 
  <span class="dt">height =</span> <span class="st">&quot;600px&quot;</span>)</code></pre></div>
<iframe src="https://luyang.shinyapps.io/gamma/?showcase=0" width="672" height="600px">
</iframe>
</div>
</div>
<div id="pareto-distribution" class="section level2 tabset">
<h2><span class="header-section-number">3.3</span> Pareto Distribution</h2>
<p>This section demonstrates the effect of the shape and scale parameters on the Pareto density function.</p>
<div id="varying-the-shape-parameter-1" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Varying the shape parameter</h3>
<p>The graph shows the Pareto density functions with varying shape parameters <span class="math inline">\((\alpha)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">3000</span>,<span class="dt">by=</span><span class="dv">1</span>)

scaleparam &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2000</span>,<span class="dv">3500</span>,<span class="dv">500</span>)
shapeparam &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>

<span class="co"># varying the shape parameter</span>
<span class="kw">plot</span>(z, <span class="kw">dparetoII</span>(z, <span class="dt">loc=</span><span class="dv">0</span>, <span class="dt">shape =</span> shapeparam[<span class="dv">1</span>], <span class="dt">scale =</span> <span class="dv">2000</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.002</span>),<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Pareto density&quot;</span>)

<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(shapeparam)){
  <span class="kw">lines</span>(z,<span class="kw">dparetoII</span>(z,<span class="dt">loc=</span><span class="dv">0</span>, <span class="dt">shape =</span> shapeparam[k], <span class="dt">scale =</span> <span class="dv">2000</span>), <span class="dt">col =</span> k)
}
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=1&#39;</span>), <span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=2&#39;</span>), <span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=3&#39;</span>), <span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=4&#39;</span>)), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
<span class="kw">title</span>(<span class="kw">substitute</span>(<span class="kw">paste</span>(<span class="st">&quot;Pdf Pareto density with&quot;</span>,<span class="st">&quot; &quot;</span>,theta,<span class="st">&quot;=2000&quot;</span>,<span class="st">&quot; &quot;</span>, <span class="st">&quot;and varying shape&quot;</span>)))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
</div>
<div id="varying-the-scale-parameter-1" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Varying the scale parameter</h3>
<p>The graph shows the Pareto density functions with varying scale parameters <span class="math inline">\((\theta)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(z, <span class="kw">dparetoII</span>(z, <span class="dt">loc=</span><span class="dv">0</span>, <span class="dt">shape =</span> <span class="dv">3</span>, <span class="dt">scale =</span> scaleparam[<span class="dv">1</span>]), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Pareto density&quot;</span>)

<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(scaleparam)){
  <span class="kw">lines</span>(z,<span class="kw">dparetoII</span>(z,<span class="dt">loc=</span><span class="dv">0</span>, <span class="dt">shape =</span> <span class="dv">3</span>, <span class="dt">scale =</span> scaleparam[k]), <span class="dt">col =</span> k)
}

<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=2000&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=2500&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=3000&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=3500&#39;</span>)), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
<span class="kw">title</span>(<span class="kw">substitute</span>(<span class="kw">paste</span>(<span class="st">&quot;Pdf Pareto density with&quot;</span>,<span class="st">&quot; &quot;</span>,alpha,<span class="st">&quot;=3&quot;</span>,<span class="st">&quot; &quot;</span>, <span class="st">&quot;and varying scale&quot;</span>)))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
</div>
<div id="weibull-distribution" class="section level2 tabset">
<h2><span class="header-section-number">3.4</span> Weibull Distribution</h2>
<p>This section demonstrates the effect of the shape and scale parameters on the Weibull density function.</p>
<div id="varying-the-shape-parameter-2" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Varying the shape parameter</h3>
<p>The graph shows the Weibull density function with varying shape parameters <span class="math inline">\((\alpha)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">400</span>,<span class="dt">by=</span><span class="dv">1</span>)

scaleparam &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">50</span>,<span class="dv">200</span>,<span class="dv">50</span>)
shapeparam &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">1.5</span>,<span class="dv">3</span>,<span class="fl">0.5</span>)

<span class="co"># varying the shape parameter</span>
<span class="kw">plot</span>(z, <span class="kw">dweibull</span>(z, <span class="dt">shape =</span> shapeparam[<span class="dv">1</span>], <span class="dt">scale =</span> <span class="dv">100</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.012</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Weibull density&quot;</span>)

<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(shapeparam)){
  <span class="kw">lines</span>(z,<span class="kw">dweibull</span>(z,<span class="dt">shape =</span> shapeparam[k], <span class="dt">scale =</span> <span class="dv">100</span>), <span class="dt">col =</span> k)
}

<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,  <span class="kw">c</span>(<span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=1.5&#39;</span>), <span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=2&#39;</span>), <span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=2.5&#39;</span>), <span class="kw">expression</span>(alpha<span class="op">~</span><span class="st">&#39;=3&#39;</span>)), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
<span class="kw">title</span>(<span class="kw">substitute</span>(<span class="kw">paste</span>(<span class="st">&quot;Pdf Weibull density with&quot;</span>,<span class="st">&quot; &quot;</span>,theta,<span class="st">&quot;=100&quot;</span>,<span class="st">&quot; &quot;</span>, <span class="st">&quot;and varying shape&quot;</span>)))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
</div>
<div id="varying-the-scale-parameter-2" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Varying the scale parameter</h3>
<p>The graph shows the Weibull density function with varying scale parameters <span class="math inline">\((\theta)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(z, <span class="kw">dweibull</span>(z, <span class="dt">shape =</span> <span class="dv">3</span>, <span class="dt">scale =</span> scaleparam[<span class="dv">1</span>]), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Weibull density&quot;</span>)

<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(scaleparam)){
  <span class="kw">lines</span>(z,<span class="kw">dweibull</span>(z,<span class="dt">shape =</span> <span class="dv">3</span>, <span class="dt">scale =</span> scaleparam[k]), <span class="dt">col =</span> k)
}
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=50&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=100&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=150&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=200&#39;</span>)), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)
<span class="kw">title</span>(<span class="kw">substitute</span>(<span class="kw">paste</span>(<span class="st">&quot;Pdf Weibull density with&quot;</span>,<span class="st">&quot; &quot;</span>,alpha,<span class="st">&quot;=3&quot;</span>,<span class="st">&quot; &quot;</span>, <span class="st">&quot;and varying scale&quot;</span>)))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="the-generalized-beta-distribution-of-the-second-kind-gb2" class="section level2 tabset">
<h2><span class="header-section-number">3.5</span> The Generalized Beta Distribution of the Second Kind (GB2)</h2>
<p>This section demonstrates the effect of the shape and scale parameters on the GB2 density function.</p>
<div id="varying-the-scale-parameter-3" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Varying the scale parameter</h3>
<p>The graph shows the GB2 density function with varying scale parameter <span class="math inline">\((\theta)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Example 4:GB2
gb2density &lt;-<span class="st"> </span><span class="cf">function</span>(x,shape1,shape2,shape3,scale){
  mu &lt;-<span class="st"> </span><span class="kw">log</span>(scale)
  sigma &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>shape3
  xt &lt;-<span class="st"> </span>(<span class="kw">log</span>(x)<span class="op">-</span>mu)<span class="op">/</span>sigma
  logexpxt&lt;-<span class="kw">ifelse</span>(xt<span class="op">&gt;</span><span class="dv">23</span>,yt,<span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">exp</span>(xt)))
  logdens &lt;-<span class="st"> </span>shape1<span class="op">*</span>xt <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(sigma) <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">beta</span>(shape1,shape2)) <span class="op">-</span><span class="st"> </span>(shape1<span class="op">+</span>shape2)<span class="op">*</span>logexpxt <span class="op">-</span><span class="kw">log</span>(x) 
  <span class="kw">exp</span>(logdens)
}
x&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">400</span>,<span class="dt">by=</span><span class="dv">1</span>)

alpha1&lt;-<span class="dv">5</span>
alpha2&lt;-<span class="dv">4</span> 
gamma &lt;-<span class="dv">2</span>
theta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">150</span>,<span class="dv">250</span>,<span class="dv">50</span>)

<span class="co"># varying the scale parameter</span>
<span class="kw">plot</span>(x, <span class="kw">gb2density</span>(x, <span class="dt">shape1=</span>alpha1,<span class="dt">shape2=</span>alpha2,<span class="dt">shape3=</span>gamma, <span class="dt">scale =</span> theta[<span class="dv">1</span>]), 
     <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Gen Beta 2 density&quot;</span>,
     <span class="dt">main =</span> 
     <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;GB2 density with &quot;</span>, alpha[<span class="dv">1</span>], <span class="st">&quot;=5,&quot;</span>, alpha[<span class="dv">2</span>], <span class="st">&quot;=4,&quot;</span>, alpha[<span class="dv">3</span>], 
                      <span class="st">&quot;=2, and varying scale (&quot;</span>,theta, <span class="st">&quot;) parameters&quot;</span>)) )

<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(theta)){
  <span class="kw">lines</span>(x,<span class="kw">gb2density</span>(x,<span class="dt">shape1=</span>alpha1,<span class="dt">shape2=</span>alpha2,<span class="dt">shape3=</span>gamma, <span class="dt">scale =</span> theta[k]), <span class="dt">col =</span> k)
}
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="kw">c</span>(<span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=150&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=200&#39;</span>), <span class="kw">expression</span>(theta<span class="op">~</span><span class="st">&#39;=250&#39;</span>)), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.6</span>,<span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Note: Here we wrote our own function for the density function of the GB2 density function.</p>
</div>
</div>
<div id="methods-of-creating-new-distributions" class="section level2 tabset">
<h2><span class="header-section-number">3.6</span> Methods of creating new distributions</h2>
<p>This section shows some of the methods of creating new distributions.</p>
<div id="mixture-distributions" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Mixture distributions</h3>
<p>The graph below creates a density function from two random variables that follow a gamma distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Example 5: A mixed density
## specify density of a mixture of 2 gamma distributions
MixtureGammaDensity &lt;-<span class="st"> </span><span class="cf">function</span>(x, a1, a2, alphaGamma1, thetaGamma1, alphaGamma2, thetaGamma2){
  a1 <span class="op">*</span><span class="st"> </span><span class="kw">dgamma</span>(x, <span class="dt">shape =</span> alphaGamma1, <span class="dt">scale =</span> thetaGamma1) <span class="op">+</span><span class="st"> </span>a2 <span class="op">*</span><span class="st"> </span><span class="kw">dgamma</span>(x, <span class="dt">shape =</span> alphaGamma2, <span class="dt">scale =</span> thetaGamma2)
}

w &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">30000</span><span class="op">/</span><span class="dv">100</span>
a1&lt;-<span class="fl">0.5</span>
a2&lt;-<span class="fl">0.5</span>
alpha1 &lt;-<span class="st"> </span><span class="dv">4</span>
theta1 &lt;-<span class="st"> </span><span class="dv">7</span>
alpha2 &lt;-<span class="st"> </span><span class="dv">15</span>
theta2 &lt;-<span class="st"> </span><span class="dv">7</span>

MixGammadens &lt;-<span class="st"> </span><span class="kw">MixtureGammaDensity</span>(w, a1,a2,alpha1, theta1, alpha2, theta2)

<span class="kw">plot</span>(w, MixGammadens, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="density-obtained-through-splicing" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Density obtained through splicing</h3>
<p>The graph below shows a density function through <a href="#" title="" data-toggle="popover" data-trigger="hover" data-content="Join together different probability density functions to form a pdf over the support of a random variable", style="color:green;">splicing</a> by combining an exponential distribution on <span class="math inline">\((0,c)\)</span> with a Pareto distribution on <span class="math inline">\((c,\infty)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Example 6: density obtained through splicing
## combine an Exp on (0,c) with a Pareto on (c,\infty)

SpliceExpPar &lt;-<span class="st"> </span><span class="cf">function</span>(x, c, v, theta, gamma, alpha){
  <span class="cf">if</span>(<span class="dv">0</span><span class="op">&lt;=</span>x <span class="op">&amp;</span><span class="st"> </span>x<span class="op">&lt;</span>c){<span class="kw">return</span>(v <span class="op">*</span><span class="st"> </span><span class="kw">dexp</span>(x, <span class="dv">1</span><span class="op">/</span>theta)<span class="op">/</span><span class="kw">pexp</span>(c,<span class="dv">1</span><span class="op">/</span>theta))}<span class="cf">else</span>
    <span class="cf">if</span>(x<span class="op">&gt;=</span>c){<span class="kw">return</span>((<span class="dv">1</span><span class="op">-</span>v)<span class="op">*</span><span class="kw">dparetoII</span>(x,<span class="dt">loc=</span><span class="dv">0</span>, <span class="dt">shape =</span> alpha, <span class="dt">scale =</span> theta)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pparetoII</span>(x,<span class="dt">loc=</span><span class="dv">0</span>, <span class="dt">shape =</span> alpha, <span class="dt">scale =</span> theta)))}
}

x &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">as.matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2500</span><span class="op">/</span><span class="dv">10</span>))

spliceValues &lt;-<span class="st"> </span><span class="kw">apply</span>(x,<span class="dv">2</span>,SpliceExpPar, <span class="dt">c =</span> <span class="dv">100</span>, <span class="dt">v =</span> <span class="fl">0.6</span>, <span class="dt">theta =</span> <span class="dv">100</span>, <span class="dt">gamma =</span> <span class="dv">200</span>, <span class="dt">alpha =</span> <span class="dv">4</span>)

<span class="kw">plot</span>(x,spliceValues, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
</div>
<div id="coverage-modifications" class="section level2">
<h2><span class="header-section-number">3.7</span> Coverage Modifications</h2>
<p><em>This file contains illustrative <strong>R</strong> code for computing important count distributions. When reviewing this code, you should open an <strong>R</strong> session, copy-and-paste the code, and see it perform. Then, you will be able to change parameters, look up commands, and so forth, as you go. </em></p>
<div id="load-required-package" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Load required package</h3>
<p>The <code>actuar</code> package provides functions for dealing with coverage modifications. In the following sections we will check the functionalities of the <code>coverage</code> command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(actuar)</code></pre></div>
</div>
<div id="ordinary-deductible" class="section level3 tabset">
<h3><span class="header-section-number">3.7.2</span> Ordinary deductible</h3>
<p>This section plots the modified probability density functions due to deductibles for the <a href="#" title="" data-toggle="popover" data-trigger="hover" data-content="Zero is observed for losses less than the deductible", style="color:green;">payment per loss</a> and <a href="#" title="" data-toggle="popover" data-trigger="hover" data-content="If the loss is less than the deductible, then the insurer does not observe the loss", style="color:green;">payment per payment</a> random variables.</p>
<div id="payment-per-loss-with-ordinary-deductible" class="section level4">
<h4><span class="header-section-number">3.7.2.1</span> Payment per loss with ordinary deductible</h4>
<p>Let <span class="math inline">\(X\)</span> be the random variable for loss size. The random variable for the payment per loss with deductible <span class="math inline">\(d\)</span> is <span class="math inline">\(Y^L=(X-d)_+\)</span>. The plot of the modified probability density function is below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="kw">coverage</span>(dgamma, pgamma, <span class="dt">deductible =</span> <span class="dv">1</span>, <span class="dt">per.loss =</span> <span class="ot">TRUE</span>)<span class="co"># create the object</span>
<span class="kw">mode</span>(f) <span class="co"># it&#39;s a function. Here deductible is 1</span></code></pre></div>
<pre><code>[1] &quot;function&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Check the pdf for Y^L at 0 and the original loss at 1
<span class="kw">f</span>(<span class="dv">0</span>, <span class="dv">3</span>) <span class="co"># mass at 0</span></code></pre></div>
<pre><code>[1] 0.0803014</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pgamma</span>(<span class="dv">0</span><span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>) <span class="co"># idem</span></code></pre></div>
<pre><code>[1] 0.0803014</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">lwd=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>) <span class="co"># original</span>
<span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)
<span class="kw">curve</span>(<span class="kw">f</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="fl">0.01</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lwd=</span><span class="dv">2</span>) <span class="co"># modified</span>
<span class="kw">points</span>(<span class="dv">0</span>, <span class="kw">f</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original pdf&quot;</span>, <span class="st">&quot;Modified pdf&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.6</span>,<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>A few quick notes on these commands:</p>
<ul>
<li>The <code>coverage()</code> function computes probability density function or cumulative distribution function of the payment per payment or payment per loss random variable under any combination of the following coverage modifications: deductible, limit, coinsurance, inflation. In this illustration we used it to compute the probability density function of the payment per loss random variable with a deductible of 1.</li>
<li>The <code>f(0, 3)</code> function calculates the pdf when the payment per loss variable is 0 with gamma parameters shape=3 and rate=1. Because we used a deductible of 1 , this should be equal to <code>pgamma(0+1, 3)</code>.</li>
</ul>
</div>
<div id="payment-per-payment-with-ordinary-deductible" class="section level4">
<h4><span class="header-section-number">3.7.2.2</span> Payment per payment with ordinary deductible</h4>
<p><span class="math inline">\(Y^P\)</span> with pdf <span class="math inline">\(f_{Y^P}(y) = f_X(y+d)/S_X(d)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="kw">coverage</span>(dgamma, pgamma, <span class="dt">deductible =</span> <span class="dv">1</span>) <span class="co"># create the object</span>

<span class="kw">f</span>(<span class="dv">0</span>, <span class="dv">3</span>) <span class="co"># calculate in x = 0, shape=3, rate=1</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">f</span>(<span class="dv">5</span>, <span class="dv">3</span>) <span class="co"># calculate in x = 5, shape=3, rate=1</span></code></pre></div>
<pre><code>[1] 0.04851322</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dgamma</span>(<span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">3</span>)<span class="op">/</span><span class="kw">pgamma</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dt">lower =</span> <span class="ot">FALSE</span>) <span class="co"># DIY</span></code></pre></div>
<pre><code>[1] 0.04851322</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)  <span class="co"># original pdf</span>
<span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">lwd=</span><span class="dv">2</span>) 
<span class="kw">curve</span>(<span class="kw">f</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="fl">0.01</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="dv">2</span>)     <span class="co"># modified pdf</span>
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original pdf&quot;</span>, <span class="st">&quot;Modified pdf&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.6</span>,<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>
<div id="per-payment-variable-with-policy-limit-coinsurance-and-inflation" class="section level4">
<h4><span class="header-section-number">3.7.2.3</span> per payment variable with policy limit, coinsurance and inflation</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="kw">coverage</span>(dgamma, pgamma, <span class="dt">deductible =</span> <span class="dv">1</span>, <span class="dt">limit =</span> <span class="dv">100</span>, <span class="dt">coinsurance =</span> <span class="fl">0.9</span>, <span class="dt">inflation =</span> <span class="fl">0.05</span>) <span class="co"># create the object</span>

<span class="kw">f</span>(<span class="dv">0</span>, <span class="dv">3</span>) <span class="co"># calculate in x = 0, shape=3, rate=1</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">f</span>(<span class="dv">5</span>, <span class="dv">3</span>) <span class="co"># calculate in x = 5, shape=3, rate=1</span></code></pre></div>
<pre><code>[1] 0.0431765</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)<span class="co"># original pdf</span>
<span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">curve</span>(<span class="kw">f</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="fl">0.01</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="dv">2</span>)     <span class="co"># modified pdf</span>
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original pdf&quot;</span>, <span class="st">&quot;Modified pdf&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.6</span>,<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
</div>
<div id="franchise-deductible" class="section level3 tabset">
<h3><span class="header-section-number">3.7.3</span> Franchise deductible</h3>
<p>A policy with a <em>franchise deductible</em> of <span class="math inline">\(d\)</span> pays nothing if the loss is no greater than <span class="math inline">\(d\)</span>, and pays the full amount of the loss if it is greater than <span class="math inline">\(d\)</span>. This section plots the pdf for the per payment and per loss random variable.</p>
<div id="payment-per-loss-with-franchise-deductible" class="section level4">
<h4><span class="header-section-number">3.7.3.1</span> Payment per loss with franchise deductible</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># franchise deductible</span>
<span class="co"># per loss variable</span>
f &lt;-<span class="st"> </span><span class="kw">coverage</span>(dgamma, pgamma, <span class="dt">deductible =</span> <span class="dv">1</span>,
<span class="dt">per.loss =</span> <span class="ot">TRUE</span>, <span class="dt">franchise =</span> <span class="ot">TRUE</span>)
<span class="kw">f</span>(<span class="dv">0</span>, <span class="dv">3</span>)       <span class="co"># mass at 0</span></code></pre></div>
<pre><code>[1] 0.0803014</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pgamma</span>(<span class="dv">1</span>, <span class="dv">3</span>)  <span class="co"># idem</span></code></pre></div>
<pre><code>[1] 0.0803014</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">f</span>(<span class="fl">0.5</span>, <span class="dv">3</span>) <span class="co"># 0 &lt; x &lt; 1</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">f</span>(<span class="dv">1</span>, <span class="dv">3</span>)   <span class="co"># x = 1</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">f</span>(<span class="dv">5</span>, <span class="dv">3</span>)   <span class="co"># x &gt; 1</span></code></pre></div>
<pre><code>[1] 0.08422434</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dgamma</span>(<span class="dv">5</span>,<span class="dv">3</span>)</code></pre></div>
<pre><code>[1] 0.08422434</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>)) <span class="co"># original</span>
<span class="kw">curve</span>(<span class="kw">f</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="fl">1.1</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>) <span class="co"># modified</span>
<span class="kw">points</span>(<span class="dv">0</span>, <span class="kw">f</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="co"># mass at 0</span>
<span class="kw">curve</span>(<span class="kw">f</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="fl">0.1</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>) <span class="co"># 0 &lt; x &lt; 1</span>
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original pdf&quot;</span>, <span class="st">&quot;Modified pdf&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.6</span>,<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>Note : to use the franchise deductible , we have to add the option <code>franchise = TRUE</code> in the coverage function.</p>
</div>
<div id="payment-per-payment-with-franchise-deductible" class="section level4">
<h4><span class="header-section-number">3.7.3.2</span> Payment per payment with franchise deductible</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># franchise deductible</span>
<span class="co"># per payment variable</span>
f &lt;-<span class="st"> </span><span class="kw">coverage</span>(dgamma, pgamma, <span class="dt">deductible =</span> <span class="dv">1</span>, <span class="dt">franchise =</span> <span class="ot">TRUE</span>)
<span class="kw">f</span>(<span class="dv">0</span>, <span class="dv">3</span>)   <span class="co"># x = 0</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">f</span>(<span class="fl">0.5</span>, <span class="dv">3</span>) <span class="co"># 0 &lt; x &lt; 1</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">f</span>(<span class="dv">1</span>, <span class="dv">3</span>) <span class="co"># x = 1</span></code></pre></div>
<pre><code>[1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">f</span>(<span class="dv">5</span>, <span class="dv">3</span>) <span class="co"># x &gt; 1</span></code></pre></div>
<pre><code>[1] 0.09157819</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dgamma</span>(<span class="dv">5</span>, <span class="dv">3</span>)<span class="op">/</span><span class="kw">pgamma</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dt">lower =</span> <span class="ot">FALSE</span>) <span class="co"># idem</span></code></pre></div>
<pre><code>[1] 0.09157819</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>))    <span class="co"># original</span>
<span class="kw">curve</span>(<span class="kw">f</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="fl">1.1</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)        <span class="co"># modified</span>
<span class="kw">curve</span>(<span class="kw">f</span>(x, <span class="dv">3</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)  <span class="co"># 0 &lt; x &lt; 1</span>
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original pdf&quot;</span>, <span class="st">&quot;Modified pdf&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.6</span>,<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<script>
$(document).ready(function(){
    $('[data-toggle="popover"]').popover(); 
});
</script>

</div>
</div>
</div>
<div id="mle-for-grouped-data" class="section level2 tabset">
<h2><span class="header-section-number">3.8</span> MLE for grouped data</h2>
<p><em>This file contains illustrative <strong>R</strong> code for computing important count distributions. When reviewing this code, you should open an <strong>R</strong> session, copy-and-paste the code, and see it perform. Then, you will be able to change parameters, look up commands, and so forth, as you go. </em></p>
<div id="mle-for-grouped-data--soa-exam-c-276" class="section level3">
<h3><span class="header-section-number">3.8.1</span> MLE for grouped data- SOA Exam C # 276</h3>
<p>Losses follow the distribution function <span class="math inline">\(F(x)=1-(\theta/x),\quad x&gt;0\)</span>. A sample of 20 losses resulted in the following:</p>
<table>
<thead>
<tr class="header">
<th align="center">Interval</th>
<th align="center">Number of Losses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">(0,10]</td>
<td align="center">9</td>
</tr>
<tr class="even">
<td align="center">(10,25]</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="center">(25,infinity)</td>
<td align="center">5</td>
</tr>
</tbody>
</table>
<p>Calculate the maximum likelihood estimate of <span class="math inline">\(\theta\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Log Likelihood function 
likgrp &lt;-<span class="st"> </span><span class="cf">function</span>(theta) {
  loglike &lt;-<span class="kw">log</span>(((<span class="dv">1</span><span class="op">-</span>(theta<span class="op">/</span><span class="dv">10</span>))<span class="op">^</span><span class="dv">9</span>)<span class="op">*</span>(((theta<span class="op">/</span><span class="dv">10</span>)<span class="op">-</span>(theta<span class="op">/</span><span class="dv">25</span>))<span class="op">^</span><span class="dv">6</span>)<span class="op">*</span><span class="st"> </span>(((theta<span class="op">/</span><span class="dv">25</span>))<span class="op">^</span><span class="dv">5</span>))
  <span class="kw">return</span>(<span class="op">-</span><span class="kw">sum</span>(loglike))
}
<span class="co">#  &quot;optim&quot; is a general purpose minimization function</span>
grplik &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="dv">1</span>),likgrp,<span class="dt">method=</span><span class="kw">c</span>(<span class="st">&quot;L-BFGS-B&quot;</span>),<span class="dt">hessian=</span><span class="ot">TRUE</span>)
<span class="co">#Estimates - Answer &quot;B&quot; on SoA Problem</span>
grplik<span class="op">$</span>par</code></pre></div>
<pre><code>[1] 5.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#standard error</span>
<span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">solve</span>(grplik<span class="op">$</span>hessian)))</code></pre></div>
<pre><code>[1] 1.11243</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#t-statistics</span>
(<span class="dt">tstat =</span> grplik<span class="op">$</span>par<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">solve</span>(grplik<span class="op">$</span>hessian))) )</code></pre></div>
<pre><code>[1] 4.944132</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Plot of Negative Log-Likelihood function </span>
vllh =<span class="st"> </span><span class="kw">Vectorize</span>(likgrp,<span class="st">&quot;theta&quot;</span>)
theta=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>, <span class="dt">by=</span><span class="fl">0.01</span>)
<span class="kw">plot</span>(theta, <span class="kw">vllh</span>(theta), <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">main =</span><span class="st">&quot;Negative Log-Likelihood function&quot;</span> , <span class="dt">cex=</span>.<span class="dv">25</span>, 
     <span class="dt">xlab=</span><span class="kw">expression</span>(theta), <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;L(&quot;</span>,theta,<span class="st">&quot;)&quot;</span>)))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
</div>
<div id="nonparametric-inference" class="section level2">
<h2><span class="header-section-number">3.9</span> Nonparametric Inference</h2>
<p><em>This file contains illustrative <strong>R</strong> code for computing important count distributions. When reviewing this code, you should open an <strong>R</strong> session, copy-and-paste the code, and see it perform. Then, you will be able to change parameters, look up commands, and so forth, as you go. This code uses the dataset <code>CLAIMLEVEL.csv</code></em></p>
<div id="nonparametric-estimation-tools" class="section level3 tabset">
<h3><span class="header-section-number">3.9.1</span> Nonparametric Estimation Tools</h3>
<p>This section illustrates non-parametric tools including moment estimators, empirical distribution function, quantiles and density estimators.</p>
<div id="moment-estimators" class="section level4">
<h4><span class="header-section-number">3.9.1.1</span> Moment estimators</h4>
<p>The <span class="math inline">\(kth\)</span> moment <span class="math inline">\(EX^k\)</span> is estimated by <span class="math inline">\(\frac{1}{n}\sum_{i=1}^{n}X_i^k\)</span>. When <span class="math inline">\(k=1\)</span> then the estimator is called the sample mean.The central moment is defined as <span class="math inline">\(E(X-\mu)^k\)</span>. When <span class="math inline">\(k=2\)</span>, then the central moment is called variance. Below illustrates the mean and variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Start with a simple example of ten points</span>
(<span class="dt">xExample =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="kw">rep</span>(<span class="dv">15</span>,<span class="dv">3</span>),<span class="dv">20</span>,<span class="kw">rep</span>(<span class="dv">23</span>,<span class="dv">4</span>),<span class="dv">30</span>))</code></pre></div>
<pre><code> [1] 10 15 15 15 20 23 23 23 23 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##summary
<span class="kw">summary</span>(xExample) <span class="co"># mean </span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   10.0    15.0    21.5    19.7    23.0    30.0 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(xExample)<span class="op">^</span><span class="dv">2</span>   <span class="co"># variance </span></code></pre></div>
<pre><code>[1] 34.45556</code></pre>
</div>
<div id="empirical-distribution-function" class="section level4">
<h4><span class="header-section-number">3.9.1.2</span> Empirical Distribution function</h4>
<p>The graph below gives the empirical distribution function <code>xExample</code> dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PercentilesxExample &lt;-<span class="st"> </span><span class="kw">ecdf</span>(xExample)

###Empirical Distribution Function
<span class="kw">plot</span>(PercentilesxExample, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
<div id="quantiles" class="section level4">
<h4><span class="header-section-number">3.9.1.3</span> Quantiles</h4>
<p>The results below gives the quantiles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##quantiles 
<span class="kw">quantile</span>(xExample)</code></pre></div>
<pre><code>  0%  25%  50%  75% 100% 
10.0 15.0 21.5 23.0 30.0 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#quantiles : set you own probabilities</span>
<span class="kw">quantile</span>(xExample, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.333333</span>))</code></pre></div>
<pre><code>      0% 33.3333% 66.6666% 99.9999% 
10.00000 15.00000 23.00000 29.99994 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#help(quantile)</span></code></pre></div>
</div>
<div id="density-estimators" class="section level4">
<h4><span class="header-section-number">3.9.1.4</span> Density Estimators</h4>
<p>The results below gives the density plots using the uniform kernel and triangular kernel.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##density plot 
<span class="kw">plot</span>(<span class="kw">density</span>(xExample), <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">density</span>(xExample, <span class="dt">bw=</span>.<span class="dv">33</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>) <span class="co"># Change the bandwidth</span></code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-59-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">density</span>(xExample, <span class="dt">kernel =</span> <span class="st">&quot;triangular&quot;</span>), <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>) <span class="co"># Change the kernel</span></code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-59-3.png" width="672" /></p>
</div>
</div>
<div id="property-fund-data" class="section level3 tabset">
<h3><span class="header-section-number">3.9.2</span> Property Fund Data</h3>
<p>This section employs non-parametric estimation tools for model selection for the claims data of the Property Fund.</p>
<div id="empirical-distribution-function-of-property-fund" class="section level4">
<h4><span class="header-section-number">3.9.2.1</span> Empirical distribution function of Property fund</h4>
<p>The results below gives the empirical distribution function of the claims and claims in logarithmic units.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ClaimLev &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;DATA/CLAIMLEVEL.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>); <span class="kw">nrow</span>(ClaimLev); <span class="co"># 6258</span></code></pre></div>
<pre><code>[1] 6258</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ClaimData&lt;-<span class="kw">subset</span>(ClaimLev,Year<span class="op">==</span><span class="dv">2010</span>);     <span class="co">#2010 subset </span>
##Empirical distribution function of Property fund
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
Percentiles  &lt;-<span class="st"> </span><span class="kw">ecdf</span>(ClaimData<span class="op">$</span>Claim)
LogPercentiles  &lt;-<span class="st"> </span><span class="kw">ecdf</span>(<span class="kw">log</span>(ClaimData<span class="op">$</span>Claim))
<span class="kw">plot</span>(Percentiles,  <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Claims&quot;</span>)
<span class="kw">plot</span>(LogPercentiles, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Logarithmic Claims&quot;</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
</div>
<div id="density-comparison" class="section level4">
<h4><span class="header-section-number">3.9.2.2</span> Density Comparison</h4>
<p>shows a histogram (with shaded gray rectangles) of logarithmic property claims from 2010. The blue thick curve represents a Gaussian kernel density where the bandwidth was selected automatically using an ad hoc rule based on the sample size and volatility of the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Density Comparison</span>
<span class="kw">hist</span>(<span class="kw">log</span>(ClaimData<span class="op">$</span>Claim), <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">35</span>),<span class="dt">xlab=</span><span class="st">&quot;Log Expenditures&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">col=</span><span class="st">&quot;lightgray&quot;</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">log</span>(ClaimData<span class="op">$</span>Claim)), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lwd=</span><span class="fl">2.5</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">log</span>(ClaimData<span class="op">$</span>Claim), <span class="dt">bw=</span><span class="dv">1</span>), <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">log</span>(ClaimData<span class="op">$</span>Claim), <span class="dt">bw=</span>.<span class="dv">1</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">density</span>(<span class="kw">log</span>(ClaimData<span class="op">$</span>Claim))<span class="op">$</span>bw   ##default bandwidth</code></pre></div>
<pre><code>[1] 0.3255908</code></pre>
</div>
</div>
<div id="nonparametric-estimation-tools-for-model-selection" class="section level3 tabset">
<h3><span class="header-section-number">3.9.3</span> Nonparametric Estimation Tools For Model Selection</h3>
<div id="fit-distributions-to-the-claims-data" class="section level4">
<h4><span class="header-section-number">3.9.3.1</span> Fit Distributions To The Claims Data</h4>
<p>The results below fits Gamma and Pareto distribution to the claims data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
<span class="kw">library</span>(VGAM)
<span class="co"># Inference assuming a gamma distribution</span>
fit.gamma2 &lt;-<span class="st"> </span><span class="kw">glm</span>(Claim<span class="op">~</span><span class="dv">1</span>, <span class="dt">data=</span>ClaimData,<span class="dt">family=</span><span class="kw">Gamma</span>(<span class="dt">link=</span>log)) 
<span class="kw">summary</span>(fit.gamma2, <span class="dt">dispersion =</span> <span class="kw">gamma.dispersion</span>(fit.gamma2)) </code></pre></div>
<pre><code>
Call:
glm(formula = Claim ~ 1, family = Gamma(link = log), data = ClaimData)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-4.287  -2.258  -1.764  -1.178  30.926  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 10.18952    0.04999   203.8   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for Gamma family taken to be 3.441204)

    Null deviance: 6569.1  on 1376  degrees of freedom
Residual deviance: 6569.1  on 1376  degrees of freedom
AIC: 28414

Number of Fisher Scoring iterations: 14</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(theta&lt;-<span class="kw">exp</span>(<span class="kw">coef</span>(fit.gamma2))<span class="op">*</span><span class="kw">gamma.dispersion</span>(fit.gamma2)) <span class="co">#mu=theta/alpha</span></code></pre></div>
<pre><code>(Intercept) 
   91613.78 </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(alpha&lt;-<span class="dv">1</span><span class="op">/</span><span class="kw">gamma.dispersion</span>(fit.gamma2) )</code></pre></div>
<pre><code>[1] 0.2905959</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  Inference assuming a Pareto Distribution</span>
fit.pareto &lt;-<span class="st"> </span><span class="kw">vglm</span>(Claim <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, paretoII, <span class="dt">loc=</span><span class="dv">0</span>, <span class="dt">data =</span> ClaimData)
<span class="kw">summary</span>(fit.pareto)</code></pre></div>
<pre><code>
Call:
vglm(formula = Claim ~ 1, family = paretoII, data = ClaimData, 
    loc = 0)


Pearson residuals:
                Min      1Q Median     3Q   Max
loge(scale)  -6.332 -0.8289 0.1875 0.8832 1.174
loge(shape) -10.638  0.0946 0.4047 0.4842 0.513

Coefficients: 
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept):1  7.7329210  0.0933332  82.853   &lt;2e-16 ***
(Intercept):2 -0.0008753  0.0538642  -0.016    0.987    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Number of linear predictors:  2 

Names of linear predictors: loge(scale), loge(shape)

Log-likelihood: -13404.64 on 2752 degrees of freedom

Number of iterations: 5 

No Hauck-Donner effect found in any of the estimates</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">fitted</span>(fit.pareto))</code></pre></div>
<pre><code>        [,1]
[1,] 2285.03
[2,] 2285.03
[3,] 2285.03
[4,] 2285.03
[5,] 2285.03
[6,] 2285.03</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto))</code></pre></div>
<pre><code>(Intercept):1 (Intercept):2 
 2282.2590626     0.9991251 </code></pre>
</div>
<div id="graphical-comparison-of-distributions" class="section level4">
<h4><span class="header-section-number">3.9.3.2</span> Graphical Comparison of Distributions</h4>
<p>The graphs below reinforces the technique of overlaying graphs for comparison purposes using both the distribution function and density function. Pareto distribution provides a better fit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plotting the fit using densities (on a logarithmic scale)</span>
<span class="co"># None of these distributions is doing a great job....</span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dt">by=</span><span class="fl">0.01</span>)

<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
LogPercentiles  &lt;-<span class="st"> </span><span class="kw">ecdf</span>(<span class="kw">log</span>(ClaimData<span class="op">$</span>Claim))
<span class="kw">plot</span>(LogPercentiles,  <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Claims&quot;</span>, <span class="dt">cex=</span><span class="fl">0.4</span>)
Fgamma_ex =<span class="st"> </span><span class="kw">pgamma</span>(<span class="kw">exp</span>(x), <span class="dt">shape =</span> alpha, <span class="dt">scale=</span>theta)
<span class="kw">lines</span>(x,Fgamma_ex,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
Fpareto_ex =<span class="st"> </span><span class="kw">pparetoII</span>(<span class="kw">exp</span>(x),<span class="dt">loc=</span><span class="dv">0</span>,<span class="dt">shape =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">2</span>]), <span class="dt">scale =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">1</span>]))
<span class="kw">lines</span>(x,Fpareto_ex,<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;log(claims)&quot;</span>, <span class="st">&quot;Gamma&quot;</span>,<span class="st">&quot;Pareto&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.6</span>,<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;purple&quot;</span>))

<span class="kw">plot</span>(<span class="kw">density</span>(<span class="kw">log</span>(ClaimData<span class="op">$</span>Claim)) ,<span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Log Expenditures&quot;</span>)
fgamma_ex =<span class="st"> </span><span class="kw">dgamma</span>(<span class="kw">exp</span>(x), <span class="dt">shape =</span> alpha, <span class="dt">scale=</span>theta)<span class="op">*</span><span class="kw">exp</span>(x)
<span class="kw">lines</span>(x,fgamma_ex,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
fpareto_ex =<span class="st"> </span><span class="kw">dparetoII</span>(<span class="kw">exp</span>(x),<span class="dt">loc=</span><span class="dv">0</span>,<span class="dt">shape =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">2</span>]), <span class="dt">scale =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">1</span>]))<span class="op">*</span><span class="kw">exp</span>(x)
<span class="kw">lines</span>(x,fpareto_ex,<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;log(claims)&quot;</span>, <span class="st">&quot;Gamma&quot;</span>,<span class="st">&quot;Pareto&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">cex=</span><span class="fl">0.6</span>,<span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;purple&quot;</span>))</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
</div>
<div id="p-p-plots" class="section level4">
<h4><span class="header-section-number">3.9.3.3</span> P-P plots</h4>
<p>shows <span class="math inline">\(pp\)</span> plots for the Property Fund data; the fitted gamma is on the left and the fitted Pareto is on the right. Pareto distribution provides a better fit again</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  PP Plot</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
Fgamma_ex =<span class="st"> </span><span class="kw">pgamma</span>(ClaimData<span class="op">$</span>Claim, <span class="dt">shape =</span> alpha, <span class="dt">scale=</span>theta)
<span class="kw">plot</span>(<span class="kw">Percentiles</span>(ClaimData<span class="op">$</span>Claim),Fgamma_ex, <span class="dt">xlab=</span><span class="st">&quot;Empirical DF&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Gamma DF&quot;</span>,<span class="dt">cex=</span><span class="fl">0.4</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)
Fpareto_ex =<span class="st"> </span><span class="kw">pparetoII</span>(ClaimData<span class="op">$</span>Claim,<span class="dt">loc=</span><span class="dv">0</span>,<span class="dt">shape =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">2</span>]), <span class="dt">scale =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">1</span>]))
<span class="kw">plot</span>(<span class="kw">Percentiles</span>(ClaimData<span class="op">$</span>Claim),Fpareto_ex, <span class="dt">xlab=</span><span class="st">&quot;Empirical DF&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Pareto DF&quot;</span>,<span class="dt">cex=</span><span class="fl">0.4</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#dev.off()</span></code></pre></div>
</div>
<div id="q-q-plots" class="section level4">
<h4><span class="header-section-number">3.9.3.4</span> q-q plots</h4>
<p>In the graphs below the quantiles are plotted on the original scale in the left-hand panels, on the log scale in the right-hand panel, to allow the analyst to see where a fitted distribution is deficient</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##q-q plot
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
xseq =<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.0001</span>, <span class="fl">0.9999</span>, <span class="dt">by=</span><span class="dv">1</span><span class="op">/</span><span class="kw">length</span>(ClaimData<span class="op">$</span>Claim))
empquant =<span class="st"> </span><span class="kw">quantile</span>(ClaimData<span class="op">$</span>Claim, xseq)
Gammaquant =<span class="st"> </span><span class="kw">qgamma</span>(xseq, <span class="dt">shape =</span> alpha, <span class="dt">scale=</span>theta)
<span class="kw">plot</span>(empquant, Gammaquant, <span class="dt">xlab=</span><span class="st">&quot;Empirical Quantile&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Gamma Quantile&quot;</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)
<span class="kw">plot</span>(<span class="kw">log</span>(empquant), <span class="kw">log</span>(Gammaquant), <span class="dt">xlab=</span><span class="st">&quot;Log Emp Quantile&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Log Gamma Quantile&quot;</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)
Paretoquant =<span class="st"> </span><span class="kw">qparetoII</span>(xseq,<span class="dt">loc=</span><span class="dv">0</span>,<span class="dt">shape =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">2</span>]), <span class="dt">scale =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">1</span>]))
<span class="kw">plot</span>(empquant, Paretoquant, <span class="dt">xlab=</span><span class="st">&quot;Empirical Quantile&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Pareto Quantile&quot;</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)
<span class="kw">plot</span>(<span class="kw">log</span>(empquant), <span class="kw">log</span>(Paretoquant), <span class="dt">xlab=</span><span class="st">&quot;Log Emp Quantile&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Log Pareto Quantile&quot;</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</code></pre></div>
<p><img src="R_for_Loss_Data_Analytics_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
</div>
<div id="goodness-of-fit-statistics" class="section level4">
<h4><span class="header-section-number">3.9.3.5</span> Goodness of Fit Statistics</h4>
<p>For reporting results, it can be effective to supplement graphical displays with selected statistics that summarize model goodness of fit. The results below provides three commonly used goodness of fit statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(goftest )
<span class="co">#Kolmogorov-Smirnov # the test statistic is &quot;D&quot;</span>
<span class="kw">ks.test</span>(ClaimData<span class="op">$</span>Claim, <span class="st">&quot;pgamma&quot;</span>, <span class="dt">shape =</span> alpha, <span class="dt">scale=</span>theta)</code></pre></div>
<pre><code>
    One-sample Kolmogorov-Smirnov test

data:  ClaimData$Claim
D = 0.26387, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ks.test</span>(ClaimData<span class="op">$</span>Claim, <span class="st">&quot;pparetoII&quot;</span>,<span class="dt">loc=</span><span class="dv">0</span>,<span class="dt">shape =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">2</span>]), <span class="dt">scale =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">1</span>]))</code></pre></div>
<pre><code>
    One-sample Kolmogorov-Smirnov test

data:  ClaimData$Claim
D = 0.047824, p-value = 0.003677
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Cramer-von Mises # the test statistic is &quot;omega2&quot;</span>
<span class="kw">cvm.test</span>(ClaimData<span class="op">$</span>Claim, <span class="st">&quot;pgamma&quot;</span>, <span class="dt">shape =</span> alpha, <span class="dt">scale=</span>theta)</code></pre></div>
<pre><code>
    Cramer-von Mises test of goodness-of-fit
    Null hypothesis: Gamma distribution
    with parameters shape = 0.290595934110839, scale =
    91613.779421033

data:  ClaimData$Claim
omega2 = 33.378, p-value = 2.549e-05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cvm.test</span>(ClaimData<span class="op">$</span>Claim, <span class="st">&quot;pparetoII&quot;</span>,<span class="dt">loc=</span><span class="dv">0</span>,<span class="dt">shape =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">2</span>]), <span class="dt">scale =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">1</span>]))</code></pre></div>
<pre><code>
    Cramer-von Mises test of goodness-of-fit
    Null hypothesis: distribution &#39;pparetoII&#39;
    with parameters shape = 0.999125131378519, scale =
    2282.25906257586

data:  ClaimData$Claim
omega2 = 0.38437, p-value = 0.07947</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Anderson-Darling # the test statistic is &quot;An&quot;</span>
<span class="kw">ad.test</span>(ClaimData<span class="op">$</span>Claim, <span class="st">&quot;pgamma&quot;</span>, <span class="dt">shape =</span> alpha, <span class="dt">scale=</span>theta)</code></pre></div>
<pre><code>
    Anderson-Darling test of goodness-of-fit
    Null hypothesis: Gamma distribution
    with parameters shape = 0.290595934110839, scale =
    91613.779421033

data:  ClaimData$Claim
An = Inf, p-value = 4.357e-07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ad.test</span>(ClaimData<span class="op">$</span>Claim, <span class="st">&quot;pparetoII&quot;</span>,<span class="dt">loc=</span><span class="dv">0</span>,<span class="dt">shape =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">2</span>]), <span class="dt">scale =</span> <span class="kw">exp</span>(<span class="kw">coef</span>(fit.pareto)[<span class="dv">1</span>]))</code></pre></div>
<pre><code>
    Anderson-Darling test of goodness-of-fit
    Null hypothesis: distribution &#39;pparetoII&#39;
    with parameters shape = 0.999125131378519, scale =
    2282.25906257586

data:  ClaimData$Claim
An = 4.1264, p-value = 0.007567</code></pre>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="frequency-distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-selection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["R for Loss Data Analytics.pdf", "R for Loss Data Analytics.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
